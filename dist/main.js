/*! For license information please see main.js.LICENSE.txt */
var e={163:function(e){var t;t=()=>(()=>{var e={909:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return(0,o.default)("/******/ (() => { // webpackBootstrap\n(function () {\n  let statsURL = null;\n  let sendTime = 60000;\n  let jsonTable = {};\n  let sendingInterval = null;\n\n  self.addEventListener(\n    'message',\n    function (e) {\n      let data = e.data;\n      //Get command parameter to identify operation\n      const { command, commandObj } = data;\n      switch (command) {\n        case 'start':\n          statsURL = commandObj\n            .replace(/ws:/, 'http:')\n            .replace(/wss:/, 'https:')\n            .replace(/mse_ld/, 'sessions');\n          start();\n          break;\n        case 'time':\n          correctSendTime(commandObj);\n          break;\n        case 'stop':\n          stop();\n          break;\n        case 'add':\n          addToTable(commandObj);\n          break;\n        default:\n          break;\n      }\n    },\n    false\n  );\n\n  function correctSendTime(time) {\n    sendTime = time;\n  }\n\n  function start() {\n    sendingInterval = this.setInterval(() => {\n      post();\n    }, sendTime);\n  }\n\n  function stop() {\n    post();\n    clearInterval(sendingInterval);\n  }\n\n  function addToTable(data) {\n    jsonTable = { ...jsonTable, ...data };\n\n    if (data.event && data.event === 'play_stop') {\n      stop();\n    }\n  }\n\n  // function roughSizeOfObject(object) {\n  //   let objectList = [];\n  //   let stack = [object];\n  //   let bytes = 0;\n\n  //   while (stack.length) {\n  //     let value = stack.pop();\n\n  //     if (typeof value === 'boolean') {\n  //       bytes += 4;\n  //     } else if (typeof value === 'string') {\n  //       bytes += value.length * 2;\n  //     } else if (typeof value === 'number') {\n  //       bytes += 8;\n  //     } else if (typeof value === 'object' && objectList.indexOf(value) === -1) {\n  //       objectList.push(value);\n\n  //       for (let i in value) {\n  //         stack.push(value[i]);\n  //       }\n  //     }\n  //   }\n  //   return bytes;\n  // }\n\n  function post() {\n    if (!jsonTable.started_at) {\n      return;\n    }\n\n    const { source_id } = jsonTable;\n    const newUrl = statsURL.replace(/sessions/, `sessions/${source_id ? `${source_id}` : ''}`);\n    fetch(newUrl, {\n      headers: {\n        Accept: 'application/json',\n        'Content-Type': 'application/json',\n      },\n      method: 'PUT',\n      body: JSON.stringify(jsonTable),\n    });\n  }\n})();\n\n/******/ })()\n;","Worker",void 0,r.p+"stats.worker.js")};var n,o=(n=r(512))&&n.__esModule?n:{default:n};e.exports=t.default},220:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return(0,o.default)("/******/ (() => { // webpackBootstrap\n(function () {\n  //Define WebSocket and protocol variables\n  let websocket = null;\n  let mustStop = false;\n\n  //Receive message from WebSocketController\n  self.addEventListener(\n    'message',\n    function (e) {\n      let data = e.data;\n      //Get command parameter to identify operation\n      let command = data.command;\n\n      if (command === 'start') {\n        //Establish WebSocket connection\n        start(data.commandObj);\n      } else if (command === 'disconnect') {\n        //Terminate WebSocket connection\n        disconnect();\n      } else if (command === 'send') {\n        sendOMMmessage(data.commandObj);\n      }\n    },\n    false\n  );\n\n  /* -----------------  Application events functions  ----------------- */\n\n  //Establish WebSocket connection\n  function start(wsURL) {\n    websocket = new WebSocket(wsURL);\n    websocket.binaryType = 'arraybuffer';\n    websocket.onopen = onOpen;\n    websocket.onmessage = onMessage;\n    websocket.onerror = onError;\n    websocket.onclose = onClose;\n  }\n\n  function disconnect() {\n    if (websocket) {\n      websocket.close();\n    }\n    mustStop = true;\n    const disconnect_response = {\n      command: 'disconnect',\n      msg: 'Disconnected',\n    };\n    self.postMessage(disconnect_response);\n  }\n\n  //Send message to ADS WebSocket\n  function sendOMMmessage(commandObj) {\n    websocket.send(commandObj);\n  }\n\n  /* -----------------  WS events  ----------------- */\n\n  //Establish WebSocket connection success\n  function onOpen() {\n    const onOpen_response = {\n      command: 'connect',\n      msg: 'Connected',\n    };\n    self.postMessage(onOpen_response);\n  }\n\n  //Receives incoming message from WebSocket\n  function onMessage(event) {\n    const rawData = event.data;\n    const isDataAB = rawData instanceof ArrayBuffer;\n    const parsedData = !isDataAB ? JSON.parse(rawData) : void 0;\n    self.postMessage({ rawData, parsedData, isDataAB });\n  }\n\n  function onError(event) {\n    const onError_response = {\n      command: 'error',\n      msg: JSON.stringify(event),\n    };\n    self.postMessage(onError_response);\n  }\n\n  function onClose(e) {\n    if (mustStop) {\n      return;\n    }\n    const { code, reason } = e;\n    const onClose_response = {\n      command: 'close',\n      data: { code, reason },\n    };\n    self.postMessage(onClose_response);\n  }\n})();\n\n/******/ })()\n;","Worker",void 0,r.p+"ws.worker.js")};var n,o=(n=r(512))&&n.__esModule?n:{default:n};e.exports=t.default},813:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,o=(n=r(624))&&n.__esModule?n:{default:n};t.default=o.default,e.exports=t.default},708:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(203),o=r(216),i=r(435),a=r(339);function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,l(n.key),n)}}function l(e){var t=function(e){if("object"!=s(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=s(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==s(t)?t:t+""}var u="segments";t.default=function(){return e=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),o.logger.log("create BuffersController"),this.media=t.media,this.init(t),this.doArrayBuffer=n.doArrayBuffer.bind(this),this.maybeAppend=this.maybeAppend.bind(this),this.onSBUpdateEnd=this.onSBUpdateEnd.bind(this),this.onAudioSBUpdateEnd=this.onAudioSBUpdateEnd.bind(this)},t=[{key:"init",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.flushRange=[],this.appended=0,this.mediaSource=e.mediaSource,this.segmentsVideo=[],this.segmentsAudio=[],this.sourceBuffer={},this.totalBytesCollected=0}},{key:"setMediaSource",value:function(e){this.mediaSource=e}},{key:"createSourceBuffers",value:function(e){var t=this,r=this.sourceBuffer;e.tracks.forEach((function(e){var n=e.content===i.VIDEO,o=n?'video/mp4; codecs="avc1.4d401f"':'audio/mp4; codecs="mp4a.40.2"';e.mime_type&&(o=e.mime_type),r[e.content]=t.mediaSource.addSourceBuffer(o),r[e.content].mode=u;var s=r[e.content];n?s.addEventListener(a.BUFFER_UPDATE_END,t.onSBUpdateEnd):s.addEventListener(a.BUFFER_UPDATE_END,t.onAudioSBUpdateEnd)}))}},{key:"onSBUpdateEnd",value:function(){if(this._needsEos&&this.checkEos(),!this._needsFlush&&this.segmentsVideo.length){var e=this.sourceBuffer.video;if(e){if(e.updating)return;var t=this.segmentsVideo[0];e.appendBuffer(t.data),this.segmentsVideo.shift(),this.videoBufferSize=this.videoBufferSize-t.data.byteLength,this.appended++}}}},{key:"onAudioSBUpdateEnd",value:function(){if(this._needsEos&&this.checkEos(),!this._needsFlush&&this.segmentsAudio.length){var e=this.sourceBuffer.audio;if(e){if(e.updating)return;var t=this.segmentsAudio[0];e.appendBuffer(t.data),this.segmentsAudio.shift(),this.appended++}}}},{key:"createTracks",value:function(e){var t=this;e.forEach((function(e){var r=(0,n.base64ToArrayBuffer)(e.payload),o={type:t.getTypeBytrackId(e.id),isInit:!0,data:r};t.maybeAppend(o)}))}},{key:"maybeAppend",value:function(e){if(!this._needsFlush){if(!this.media||this.media.error)return"audio"===e.type?this.segmentsAudio=[]:this.segmentsVideo=[],o.logger.error("trying to append although a media error occured, flush segment and abort"),void(this.media.error&&o.logger.error("Error code:",this.media.error));var t=this.sourceBuffer[e.type];if(t){if(t.updating)return;t.appendBuffer(e.data),"audio"===e.type?this.segmentsAudio.shift():this.segmentsVideo.shift(),this.appended++}}}},{key:"setTracksByType",value:function(e){var t=this,r=e.tracks?"tracks":"streams";1===e[r].length&&(this.audioTrackId=null),e[r].forEach((function(e,r){t[e.content===i.VIDEO?"videoTrackId":"audioTrackId"]={index:r,id:e.id}}))}},{key:"getTypeBytrackId",value:function(e){return this.audioTrackId&&this.audioTrackId.id===e?i.AUDIO:i.VIDEO}},{key:"procArrayBuffer",value:function(e){var t=this.rawDataToSegmnet(e);"audio"===t.type?this.segmentsAudio.push(t):this.segmentsVideo.push(t),this.totalBytesCollected=this.totalBytesCollected+t.data.byteLength,this.doArrayBuffer(t),this.sourceBuffer&&(this.sourceBuffer.video&&!this.sourceBuffer.video.updating&&this.onSBUpdateEnd(),this.audioTrackId&&this.sourceBuffer.audio&&!this.sourceBuffer.audio.updating&&this.onAudioSBUpdateEnd())}},{key:"seek",value:function(){for(var e in this.sourceBuffer)this.sourceBuffer[e].abort(),this.sourceBuffer[e].mode=u}},{key:"isBuffered",value:function(){var e=0,t=this.sourceBuffer;for(var r in t)e+=t[r].buffered.length;return e>0}},{key:"doFlush",value:function(){for(;this.flushRange.length;){var e=this.flushRange[0];if(!this.flushBuffer(e.start,e.end,e.type))return void(this._needsFlush=!0);this.flushRange.shift(),this.flushBufferCounter=0}if(0===this.flushRange.length){this._needsFlush=!1;var t=0,r=this.sourceBuffer;try{for(var n in r)t+=r[n].buffered.length}catch(e){o.logger.error("error while accessing sourceBuffer.buffered")}this.appended=t,this._setTracksFlag=!1}}},{key:"flushBuffer",value:function(e,t,r){var n,i,a,s,c,l,u=this.sourceBuffer;if(Object.keys(u).length){if(o.logger.log("flushBuffer,pos/start/end: ".concat(this.media.currentTime.toFixed(3),"/").concat(e,"/").concat(t)),this.flushBufferCounter<this.appended){for(var p in u)if(!r||p===r){if((n=u[p]).ended=!1,n.updating)return o.logger.warn("cannot flush, sb updating in progress"),!1;try{for(i=0;i<n.buffered.length;i++)if(a=n.buffered.start(i),s=n.buffered.end(i),-1!==navigator.userAgent.toLowerCase().indexOf("firefox")&&t===Number.POSITIVE_INFINITY?(c=e,l=t):(c=Math.max(a,e),l=Math.min(s,t)),Math.min(l,s)-c>.5)return this.flushBufferCounter++,o.logger.log("flush ".concat(p," [").concat(c,",").concat(l,"], of [").concat(a,",").concat(s,"], pos:").concat(this.media.currentTime)),n.remove(c,l),!1}catch(e){o.logger.warn("exception while accessing sourcebuffer, it might have been removed from MediaSource")}}}else o.logger.warn("abort flushing too many retries");o.logger.log("buffer flushed")}return!0}},{key:"rawDataToSegmnet",value:function(e){var t=new Uint8Array(e),r=(0,n.getTrackId)(t);return{type:this.getTypeBytrackId(r),data:t}}},{key:"onBufferEos",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.sourceBuffer,r=e.type;for(var n in t)r&&n!==r||t[n].ended||(t[n].ended=!0,o.logger.log("".concat(n," sourceBuffer now EOS")));this.checkEos()}},{key:"checkEos",value:function(){var e=this.sourceBuffer,t=this.mediaSource;if(t&&"open"===t.readyState){for(var r in e){var n=e[r];if(!n.ended)return;if(n.updating)return void(this._needsEos=!0)}o.logger.log("all media data available, signal endOfStream() to MediaSource and stop loading fragment");try{t.endOfStream()}catch(e){o.logger.warn("exception while calling mediaSource.endOfStream()")}this._needsEos=!1}else this._needsEos=!1}},{key:"addSourceBuffer",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"audio",t=this.sourceBuffer,r="video"===e?'video/mp4; codecs="avc1.4d401f"':'audio/mp4; codecs="mp4a.40.2"';t[e]=this.mediaSource.addSourceBuffer(r),t[e].mode=u;var n=t[e];"video"===e?n.addEventListener(a.BUFFER_UPDATE_END,this.onSBUpdateEnd):n.addEventListener(a.BUFFER_UPDATE_END,this.onAudioSBUpdateEnd)}},{key:"removeSourceBuffer",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"audio",t=this.sourceBuffer[e];"audio"===e?t.removeEventListener(a.BUFFER_UPDATE_END,this.onAudioSBUpdateEnd):t.removeEventListener(a.BUFFER_UPDATE_END,this.onSBUpdateEnd),this.mediaSource.removeSourceBuffer(t),delete this.sourceBuffer[e]}},{key:"destroy",value:function(){this.init()}}],t&&c(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}(),e.exports=t.default},97:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,t.getWSURL=p;var n=a(r(189)),o=a(r(220)),i=r(216);function a(e){return e&&e.__esModule?e:{default:e}}function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,l(n.key),n)}}function l(e){var t=function(e){if("object"!=s(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=s(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==s(t)?t:t+""}var u="live";function p(e,t,r,o){var a=t=u;if(!a&&!r&&!o)return e;var s=(0,n.default)({url:e}),c="";s.query&&(c=s.query.split("&").map((function(e){return e.split("=")})).filter((function(e){return"from"!==e[0]&&"tracks"!==e[0]})).map((function(e){return e.join("=")})).join("&"),i.logger.log(c));var l="".concat(s.protocol,"//").concat(s.host).concat(s.pathname,"?"),p=!!r||!!o,f=p&&a&&a!==u?"&":"",h=t===u?"":"from=".concat(Math.floor(a));return t||(h=""),"".concat(l).concat(p?"tracks=".concat(r).concat(o):"")+"".concat(f).concat(h)+"".concat((p||a&&a!==u)&&c?"&":"").concat(c)}t.default=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.opts=t,this.init(),this.onwso=this.open.bind(this),this.onwsm=this.handleReceiveMessage.bind(this),this.onwse=this.handleError.bind(this),this.onwsc=this.onWSClose.bind(this)},t=[{key:"init",value:function(){this.wsWorker&&delete this.wsWorker,this.opened=!1,this.connectionPromise=void 0,clearTimeout(this.reconnect),this.reconnect=void 0,window.Worker&&(this.wsWorker=new o.default,this.wsWorker.onmessage=this.onWorkerMessage.bind(this))}},{key:"onWorkerMessage",value:function(e){var t=e.data;switch(t.command){case"connect":this.open();break;case"close":this.onWSClose(t);break;case"error":this.handleError(t);break;default:this.handleReceiveMessage(t)}}},{key:"start",value:function(e,t){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";return this.connectionPromise=new Promise((function(i,a){r.socketURL={url:e,time:t,videoTrack:n,audioTack:o};var s=p(e,t,n,o);r.wsWorker.postMessage({command:"start",commandObj:s}),r._openingResolve=i,r._openingReject=a})),this.connectionPromise}},{key:"open",value:function(){this.opened||(this.opened=!0,this.paused=!0,this._openingResolve())}},{key:"send",value:function(e){this.wsWorker.postMessage({command:"send",commandObj:e})}},{key:"resume",value:function(){clearTimeout(this.reconnect),i.logger.log("ws: send resume"),this.send("resume"),this.paused=!1}},{key:"pause",value:function(){i.logger.log("ws: send pause"),this.send("pause"),this.paused=!0}},{key:"seek",value:function(e){var t=e===u?"":"play_from=";i.logger.log("".concat(t).concat(e)),this.send("".concat(t).concat(e))}},{key:"setTracks",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.send("set_tracks=".concat(e).concat(t))}},{key:"sendStats",value:function(e){var t=JSON.stringify(e);this.send(t)}},{key:"handleReceiveMessage",value:function(e){this.opts.message(e)}},{key:"handleError",value:function(){var e;this.opts.error&&(e=this.opts).error.apply(e,arguments)}},{key:"onWSClose",value:function(e){var t=this;if(i.logger.log("WebSocket lost connection with code ",e.code+" and reason: "+e.reason),this.opts.error&&this.opts.error({error:"WebSocket lost connection",err:"WebSocket lost connection with code ".concat(e.code," and reason: ").concat(e.reason),code:e.code}),this.opts.wsReconnect)if(e.wasClean&&1e3!==e.code&&1006!==e.code)i.logger.log("Clean websocket stop"),this.destroy();else{var r=this.socketURL,n=r.url,o=r.videoTrack,a=r.audioTack;this.reconnect=setTimeout((function(){t.start(n,o,a).then((function(){clearTimeout(t.reconnect)})).catch((function(){t.destroy()}))}),5e3)}this.opts.closed&&this.opts.closed(e)}},{key:"destroy",value:function(){this.wsWorker.postMessage({command:"disconnect"}),clearTimeout(this.reconnect),this.reconnect=void 0,this.init()}}],t&&c(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}()},435:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.VIDEO=t.AUDIO=void 0,t.VIDEO="video",t.AUDIO="audio"},339:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,t.default={MEDIA_SOURCE_SOURCE_OPEN:"sourceopen",MEDIA_SOURCE_SOURCE_ENDED:"sourceended",MEDIA_SOURCE_SOURCE_CLOSE:"sourceclose",MEDIA_ELEMENT_PLAY:"play",MEDIA_ELEMENT_PAUSE:"pause",MEDIA_ELEMENT_PROGRESS:"progress",MEDIA_ELEMENT_EMPTIED:"emptied",MEDIA_ELEMENT_SUSPEND:"suspend",MEDIA_ELEMENT_STALLED:"stalled",MEDIA_ELEMENT_WAITING:"waiting",MEDIA_ELEMENT_RATECHANGE:"ratechange",MEDIA_ELEMENT_PLAYING:"playing",WS_OPEN:"open",WS_MESSAGE:"message",WS_ERROR:"error",WS_CLOSE:"close",BUFFER_UPDATE_END:"updateend",BUFFER_ERROR:"onerror",BUFFER_ABORT:"onabort"},e.exports=t.default},534:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,t.default={NOT_HTML_MEDIA_ELEMENT:"media should be an HTMLMediaElement instance"},e.exports=t.default},52:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MSE_MEDIA_SEGMENT=t.MSE_INIT_SEGMENT=t.EVENT_SEGMENT=void 0,t.EVENT_SEGMENT="event",t.MSE_INIT_SEGMENT="mse_init_segment",t.MSE_MEDIA_SEGMENT="mse_media_segment"},624:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=h(r(97)),o=h(r(708)),i=h(r(909)),a=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!=d(e)&&"function"!=typeof e)return{default:e};var r=f(t);if(r&&r.has(e))return r.get(e);var n={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&{}.hasOwnProperty.call(e,i)){var a=o?Object.getOwnPropertyDescriptor(e,i):null;a&&(a.get||a.set)?Object.defineProperty(n,i,a):n[i]=e[i]}return n.default=e,r&&r.set(e,n),n}(r(203)),s=r(216),c=r(52),l=r(435),u=h(r(339)),p=h(r(534));function f(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(f=function(e){return e?r:t})(e)}function h(e){return e&&e.__esModule?e:{default:e}}function d(e){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d(e)}function y(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function m(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?y(Object(r),!0).forEach((function(t){g(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):y(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function g(e,t,r){return(t=E(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function v(){v=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function u(e,t,r,n){var i=t&&t.prototype instanceof b?t:b,a=Object.create(i.prototype),s=new I(n||[]);return o(a,"_invoke",{value:A(e,r,s)}),a}function p(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var f="suspendedStart",h="suspendedYield",y="executing",m="completed",g={};function b(){}function S(){}function w(){}var E={};l(E,a,(function(){return this}));var _=Object.getPrototypeOf,k=_&&_(_(D([])));k&&k!==r&&n.call(k,a)&&(E=k);var O=w.prototype=b.prototype=Object.create(E);function T(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function j(e,t){function r(o,i,a,s){var c=p(e[o],e,i);if("throw"!==c.type){var l=c.arg,u=l.value;return u&&"object"==d(u)&&n.call(u,"__await")?t.resolve(u.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(u).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,s)}))}s(c.arg)}var i;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){r(e,n,t,o)}))}return i=i?i.then(o,o):o()}})}function A(t,r,n){var o=f;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=M(s,n);if(c){if(c===g)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===f)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var l=p(t,r,n);if("normal"===l.type){if(o=n.done?m:h,l.arg===g)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(o=m,n.method="throw",n.arg=l.arg)}}}function M(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,M(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var i=p(o,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,g;var a=i.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function P(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function x(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function I(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(P,this),this.reset(!0)}function D(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return i.next=i}}throw new TypeError(d(t)+" is not iterable")}return S.prototype=w,o(O,"constructor",{value:w,configurable:!0}),o(w,"constructor",{value:S,configurable:!0}),S.displayName=l(w,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===S||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,w):(e.__proto__=w,l(e,c,"GeneratorFunction")),e.prototype=Object.create(O),e},t.awrap=function(e){return{__await:e}},T(j.prototype),l(j.prototype,s,(function(){return this})),t.AsyncIterator=j,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new j(u(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},T(O),l(O,c,"Generator"),l(O,a,(function(){return this})),l(O,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=D,I.prototype={constructor:I,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(x),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function o(n,o){return s.type="throw",s.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(c&&l){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),x(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;x(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:D(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),g}},t}function b(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}function S(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){b(i,n,o,a,s,"next",e)}function s(e){b(i,n,o,a,s,"throw",e)}a(void 0)}))}}function w(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,E(n.key),n)}}function E(e){var t=function(e){if("object"!=d(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=d(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==d(t)?t:t+""}var _=l.VIDEO,k=l.AUDIO;t.default=function(){function e(t,c){var l=this,u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),u.debug&&((0,s.enableLogs)(!0),window.humanTime=a.humanTime),s.logger.info("[mse-player]:",e.version),this.opts=u||{},this.media=t,this.url=c,this.firstStart=!0,this.opts.progressUpdateTime=this.opts.progressUpdateTime||500,this.opts.errorsBeforeStop=this.opts.errorsBeforeStop?this.opts.errorsBeforeStop:1,"number"!=typeof this.opts.errorsBeforeStop||isNaN(this.opts.errorsBeforeStop))throw new Error("invalid errorsBeforeStop param, should be number");if(this.opts.connectionRetries=this.opts.connectionRetries||0,"number"!=typeof this.opts.connectionRetries||isNaN(this.opts.connectionRetries))throw new Error("invalid connectionRetries param, should be number");if(this.opts.wsReconnect=!!this.opts.wsReconnect&&this.opts.wsReconnect,"boolean"!=typeof this.opts.wsReconnect)throw new Error("invalid wsReconnect param, should be boolean");if(this.opts.preferHQ=!!this.opts.preferHQ&&this.opts.preferHQ,"boolean"!=typeof this.opts.preferHQ)throw new Error("invalid preferHQ param, should be boolean");if(this.retry=0,this.retryConnectionTimer,this.opts.retryMuted=!!this.opts.retryMuted&&this.opts.retryMuted,"boolean"!=typeof this.opts.retryMuted)throw new Error("invalid retryMuted param, should be boolean");this.opts.maxBufferDelay=this.opts.maxBufferDelay?this.opts.maxBufferDelay:2;var p=navigator.userAgent;if((/Edge/.test(p)||/trident.*rv:1\d/i.test(p))&&(this.opts.maxBufferDelay=10),"number"!=typeof this.opts.maxBufferDelay)throw new Error("invalid maxBufferDelay param, should be number");if(this.opts.videoQuality){if("string"!=typeof this.opts.videoQuality)throw new Error("invalid videoQuality param, should be string");if("highest"!==this.opts.videoQuality&&"lowest"!==this.opts.videoQuality)throw new Error("invalid videoQuality param, should be highest or lowest")}try{this.Sentry=r(Object(function(){var e=new Error("Cannot find module '@sentry/browser'");throw e.code="MODULE_NOT_FOUND",e}()))}catch(e){this.noSentry=!0}if(this.opts.sentryConfig=this.opts.sentryConfig?this.opts.sentryConfig:"","string"!=typeof this.opts.sentryConfig)throw new Error("invalid sentryConfig param, should be string");if(this.opts.sentryConfig.length&&!this.noSentry&&(this.Sentry.init({dsn:this.opts.sentryConfig,environment:"production",release:"Mse Player@"+e.version}),document.onerror=function(e){l.Sentry.captureException(e)}),"number"!=typeof this.opts.maxBufferDelay)throw new Error("invalid maxBufferDelay param, should be number");if(this.opts.statsSendEnable=!("statsSendEnable"in this.opts)||"boolean"!=typeof this.opts.statsSendEnable||!1!==this.opts.statsSendEnable,window.Worker&&this.opts.statsSendEnable){if(this.statsWorker=new i.default,this.statsWorker.onmessage=this.onStatsWorkerMessage.bind(this),this.opts.statsSendTime){if("number"!=typeof this.opts.statsSendTime)throw new Error("invalid statsSendTime param, should be number");this.statsWorker.postMessage({command:"time",commandObj:1e3*this.opts.statsSendTime})}this.statsWorker.postMessage({command:"start",commandObj:this.url}),this.statsWorkerStarted=!0}this.resetStats=function(){l.playerStatsObject={proto:"mseld",user_agent:navigator.userAgent,bytes:0,application:{application_name:"mseld_player",application_version:e.version,stall_count:0,pause_count:0,error_count:0,reconnect_count:0,bitrate_change_count:0,live_duration:0,stall_duration:0,pause_duration:0,total_video_frames:0,dropped_video_frames:0,corrupted_video_frames:0}},l.addStat(l.playerStatsObject),!l.statsWorkerStarted&&l.opts.statsSendEnable&&(l.statsWorker.postMessage({command:"start",commandObj:l.url}),l.statsWorkerStarted=!0)},this.onProgress=u&&u.onProgress,u&&u.onDisconnect?this.onDisconnect=u&&u.onDisconnect:this.onDisconnect=function(e){s.logger.log("[websocket status]:",e)},this.onMediaInfo=u&&u.onMediaInfo,this.onError=u&&u.onError,this.onEventCallback=u&&u.onEvent,this.onAutoplay=u&&u.onAutoplay,this.onMuted=u&&u.onMuted,this.onStats=u&&u.onStats,this.onMessage=u&&u.onMessage,this.onPause=u&&u.onPause,this.onResume=u&&u.onResume,t instanceof HTMLMediaElement&&(t.WebKitPlaysInline=!0,t.controls=!1),this.ws=new n.default({message:this.dispatchMessage.bind(this),closed:this.onDisconnect.bind(this),error:this.onError,wsReconnect:this.opts.wsReconnect}),this.sb=new o.default({media:t}),this.messageTime=Date.now(),this.init()}return t=e,l=[{key:"play",value:function(e,t){var r=this;if(s.logger.log("[mse-player]: play(".concat(e,", ").concat(t,")")),this.playing)s.logger.log("MSE is already playing");else{if(!this.ws||!this.ws.websocket||this._pause)return new Promise((function(n,o){if(!r.mediaSource||"open"!==r.mediaSource.readyState)return r.mediaSource||r.onAttachMedia({media:r.media}).then((function(){r.onsoa=r._play.bind(r,e,t),r.sb.setMediaSource(r.mediaSource),r.mediaSource.addEventListener(u.default.MEDIA_SOURCE_SOURCE_OPEN,r.onsoa),s.logger.warn("mediaSource did not create"),r.resolveThenMediaSourceOpen=r.resolveThenMediaSourceOpen?r.resolveThenMediaSourceOpen:n,r.rejectThenMediaSourceOpen=r.rejectThenMediaSourceOpen?r.rejectThenMediaSourceOpen:o})),r.mediaSource&&"open"!==r.mediaSource.readyState?(s.logger.warn('readyState is not "open", it\'s currently ',r.mediaSource.readyState),r.shouldPlay=!0,r.resolveThenMediaSourceOpen=r.resolveThenMediaSourceOpen?r.resolveThenMediaSourceOpen:n,void(r.rejectThenMediaSourceOpen=r.rejectThenMediaSourceOpen?r.rejectThenMediaSourceOpen:o)):void 0;r._play()}));s.logger.log("[mse-player]: websocket already opened")}}},{key:"stop",value:function(){var e=this;this.playPromise?(this.onEvent({key:Date.now(),data:{event:"play_stop"}}),this.playerStatsObject.closed_at=Date.now(),this.addStat({closed_at:this.playerStatsObject.closed_at}),this.opts.statsSendEnable&&(this.statsWorkerStarted=!1),this.playPromise.catch(S(v().mark((function t(){return v().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.resetTimer&&(clearTimeout(e.resetTimer),e.resetTimer=void 0),!e._stop){t.next=4;break}return s.logger.log("[mse-player]: already stopped"),t.abrupt("return");case 4:return t.next=6,e.onMediaDetaching();case 6:case"end":return t.stop()}}),t)})))).finally(S(v().mark((function t(){return v().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.resetTimer&&(clearTimeout(e.resetTimer),e.resetTimer=void 0),!e._stop){t.next=4;break}return s.logger.log("[mse-player]: already stopped"),t.abrupt("return");case 4:return t.next=6,e.onMediaDetaching();case 6:case"end":return t.stop()}}),t)}))))):(this.resetTimer&&(clearTimeout(this.resetTimer),this.resetTimer=void 0),this.endProgressTimer(),s.logger.log("[mse-player]: no playPromise exists, nothing to stop")),this.firstStart=!0,delete this.uuid}},{key:"pause",value:function(){if(!function(){return!(!(!this._pause&&this.playing&&this.media&&this.ws&&this.mediaSource)||this.mediaSource&&"open"!==this.mediaSource.readyState||!this.playPromise)}.bind(this)())return s.logger.log("[mse:playback] can not do pause");var e=function(){if(this.ws.pause(),this.media.pause(),this._pause=!0,this.playing=!1,this.addPlayerStat("pause_count"),this.pauseStarted=Date.now(),this.onPause)try{this.onPause()}catch(e){s.logger.error("Error "+e.name+":"+e.message+"\n"+e.stack)}}.bind(this);this.playPromise.then(e,e).catch(e,e)}},{key:"restart",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&!arguments[0]?this.sb.lastLoadedUTC:void 0;this.playing=!1,this.ws.destroy(),this.ws.init(),this.ws.start(this.url,e,this.videoTrack,this.audioTrack),this.addPlayerStat("reconnect_count"),this.onEndStalling()}},{key:"retryConnection",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.retry>=this.opts.connectionRetries?clearInterval(this.retryConnectionTimer):(s.logger.log("%cconnectionRetry:","background: orange;","Retrying ".concat(this.retry+1)),this.mediaSource=void 0,this.init(),this.ws.destroy(),this.sb.destroy(),this.play(t,r).then((function(){e.onEndStalling()})),this.retry=this.retry+1)}},{key:"setTracks",value:function(e){var t=this,r=e;if(this.mediaInfo){if("lowest"===r)r=this.autoTrackSelection(!1);else if("highest"===r)r=this.autoTrackSelection(!0);else if(!Array.isArray(r))return void s.logger.error('tracks should be an Array instance: ["v1", "a1"]');if(this.playing){var n=this.mediaInfo.streams?"streams":"tracks",o=r.filter((function(e){var r=t.mediaInfo[n].find((function(t){return e===t.track_id}));return!!r&&r.content===_})).join(""),i=r.filter((function(e){var r=t.mediaInfo[n].find((function(t){return e===t.track_id}));return r?!!r&&r.content===k:null})).join("");if(!i.length&&!o.length){s.logger.warn("No such stream tracks! Setting to default parameters");var a=this.getVideoTracks(),c=this.getAudioTracks();c.length?i=c[0].track_id:s.logger.warn("No audio tracks"),a.length?o=a[0].track_id:s.logger.warn("No video tracks")}if(i.length||(this.sb.sourceBuffer.audio&&this.sb.removeSourceBuffer(),this.media.muted=!0,s.logger.warn("No audio tracks")),o.length&&i.length&&this.mediaSource.sourceBuffers.length<=1)return this.stop(),this.videoTrack=o,this.audioTrack=i,void(this._stop?this.play(o,i):setTimeout((function(){t.play(o,i)}),0));this.onStartStalling(),this.ws.setTracks(o,i),this.addPlayerStat("bitrate_change_count"),this.videoTrack=o,this.audioTrack=i,this._setTracksFlag=!0,this.waitForInitFrame=!0}else this.pendingTracks=r}else s.logger.warn("Media info did not loaded. Should try after onMediaInfo triggered or inside.")}},{key:"autoTrackSelection",value:function(e){if(this.mediaInfo){var t,r,n,o,i,a,c,l=this.getVideoTracks(),u=this.getAudioTracks();e?(1===l.length?t=l[0].track_id:(l[0].bitrate?o="bitrate":l[0].pixel_width&&(o="pixel_width"),n=l[0][o],t=l[0].track_id,l.forEach((function(e){e[o]>n&&(n=e[o],t=e.track_id)}))),u.length&&(1===u.length?r=u[0].track_id:(r=u[0].track_id,u.forEach((function(e){e.sample_rate>n&&(r=e.track_id)}))))):(1===l.length?t=l[0].track_id:(l[0].bitrate?a="bitrate":l[0].pixel_width&&(a="pixel_width"),i=l[0][a],t=l[0].track_id,l.forEach((function(e){e[a]<i&&(i=e[a],t=e.track_id)}))),u.length&&(1===u.length?r=u[0].track_id:(c=u[0].sample_rate,r=u[0].track_id,u.forEach((function(e){e.sample_rate<c&&(c=e.sample_rate,r=e.track_id)})))));var p=[];return t&&t.length&&p.push(t),r&&r.length&&p.push(r),p}s.logger.warn("Media info did not loaded. Should try after onMediaInfo triggered or inside.")}},{key:"_play",value:function(e,t){var r=this;return this.opts.debug&&console.trace("_play",e,t),new Promise((function(n,o){if(s.logger.log("_play",e,t),r.playing){var i="[mse-player] _play: terminate because already has been playing";return s.logger.log(i),n({message:i})}if(r._pause){if(r.ws&&!1===r.ws.opened)return s.logger.log("WebSocket Closed, trying to restart it"),r._pause=!1,void r.restart(!0);if(s.logger.log("WebSocket is in opened state, resuming"),r._pause=!1,r._resume(),r.pauseStarted){var a=r.playerStatsObject.application;if(a){var c=a.pause_duration;c+=Date.now()-r.pauseStarted,r.addPlayerStat("pause_duration",!1,c),delete r.pauseStarted}}return r.playPromise=r.media.play(),s.logger.log("_play: terminate because _paused and should resume"),r.playPromise}r.resetStats(),r.playerStatsObject.opened_at=Date.now(),r.uuid=r.generateUUID(),r.addStat({opened_at:r.playerStatsObject.opened_at,id:r.uuid}),r.videoTrack=e,r.audioTrack=t,r._pause=!1;var l=new Promise((function(e,t){return!r.media.autoplay||!0===r.media.muted||r.opts.retryMuted?e():!r.onAutoplay||function(){var e=["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod","Safari"];if(navigator.platform)for(;e.length;)if(navigator.platform===e.pop())return!0;return!1}()?(r.media.muted=!0,e()):(r.onAutoplay((function(){return r.media.muted=!1,e()})),void t())}));l.then((function(){r.liveError||r.ws.start(r.url,r.playTime,r.videoTrack,r.audioTrack).then((function(){return r.playPromise=r.media.play(),r.playPromise.then((function(){r.onStartStalling(),r.startProgressTimer(),r.resolveThenMediaSourceOpen&&(r._stop=!1,r.resolveThenMediaSourceOpen(),r.resolveThenMediaSourceOpen=void 0,r.rejectThenMediaSourceOpen=void 0,clearInterval(r.retryConnectionTimer),r.retry=0),r.onEvent({key:Date.now(),data:{event:"play_started"}})})).catch((function(n){s.logger.log("playPromise rejection.",n),r.ws.connectionPromise&&r.ws.connectionPromise.then((function(){return r.ws.destroy()})),r.opts.retryMuted&&0==r.media.muted&&(r.onMuted&&r.onMuted(),r.media.muted=!0,r._play(e,t)),r.onPlayerError({error:"play_promise_reject",err:n}),r.rejectThenMediaSourceOpen&&(r.rejectThenMediaSourceOpen(),r.resolveThenMediaSourceOpen=void 0,r.rejectThenMediaSourceOpen=void 0),r.opts.retryMuted||r.stop()})),r.playPromise}))}))}))}},{key:"init",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._pause=!1,this.playing=!1,this.liveError=!1,this.shouldPlay=!1,this.audioTrack="",this.videoTrack="",this.endProgressTimer(),t||this.onEvent({key:Date.now(),data:{event:"play_init",userInfo:window.navigator.userAgent,playerInfo:"MSEPlayer".concat(e.version?"@".concat(e.version):"")}})}},{key:"_resume",value:function(){this.ws.resume(),this.onEvent({key:Date.now(),data:{event:"play_websocket_resume"}})}},{key:"onMediaDetaching",value:function(){var e=this;if(this.stopRunning)s.logger.warn("stop is running.");else{if(this.stopRunning=!0,this.handlerMediaDetaching.bind(this),!this.playPromise)return this.handlerMediaDetaching();this.playPromise.catch((function(){return e.handlerMediaDetaching()})).finally((function(){return e.handlerMediaDetaching()}))}}},{key:"handlerMediaDetaching",value:function(){var e=this;return s.logger.info("media source detaching"),new Promise((function(t,r){if(e.removeMediaSource(),!e.media)return r("no media to detach");e.removeListeners(),e.oncvp=null,e.mediaSource=null,e.init(!0),e.ws.destroy(),e.sb.destroy(),e.media.onemptied=function(){return s.logger.log("[mse-player]: media emptied"),e.stopRunning=!1,e._stop=!0,delete e.playPromise,t()}}))}},{key:"removeMediaSource",value:function(){var e=this,t=this.mediaSource;if(t){if("open"===t.readyState)try{t.endOfStream()}catch(e){s.logger.warn("onMediaDetaching:".concat(e.message," while calling endOfStream"))}t.removeEventListener(u.default.MEDIA_SOURCE_SOURCE_OPEN,this.onmso),t.removeEventListener(u.default.MEDIA_SOURCE_SOURCE_ENDED,this.onmse),t.removeEventListener(u.default.MEDIA_SOURCE_SOURCE_CLOSE,this.onmsc),this.onmso=null,this.onmse=null,this.onmsc=null}var r=function(){e.media.src="",e.media.load(),e.resetTimer&&(clearTimeout(e.resetTimer),e.resetTimer=void 0)};this.playPromise&&this.playPromise.then((function(){r()})).catch((function(){r()}))}},{key:"onMediaElementEmptied",value:function(e){return this.onMediaElementEmptied&&this.media&&(this.media.removeEventListener(u.default.MEDIA_ELEMENT_EMPTIED,this.onMediaElementEmptied),this._onmee=void 0),e}},{key:"onAttachMedia",value:function(e){var t=this;this.media=e.media;var r=this.media;if(!(r instanceof HTMLMediaElement))throw new Error(p.default.NOT_HTML_MEDIA_ELEMENT);if(r){var n=this.mediaSource=new MediaSource;return this.onmse=this.onMediaSourceEnded.bind(this),this.onmsc=this.onMediaSourceClose.bind(this),n.addEventListener(u.default.MEDIA_SOURCE_SOURCE_ENDED,this.onmse),n.addEventListener(u.default.MEDIA_SOURCE_SOURCE_CLOSE,this.onmsc),r.src=URL.createObjectURL(n),this.eventLog=function(e){t.onEvent&&t.onEvent(e)},this.addListeners(),this.liveError?void(this.player=void 0):new Promise((function(e){t.onmso=t.onMediaSourceOpen.bind(t,e),n.addEventListener(u.default.MEDIA_SOURCE_SOURCE_OPEN,t.onmso)}))}}},{key:"onMediaSourceOpen",value:function(e){e();var t=this.mediaSource;t&&t.removeEventListener(u.default.MEDIA_SOURCE_SOURCE_OPEN,this.onmso),URL.revokeObjectURL(this.media.src),this.shouldPlay&&(this.shouldPlay=!1,s.logger.info("readyState now is ".concat(this.mediaSource.readyState,", and will be played"),this.videoTrack,this.audioTrack),this._play(this.videoTrack,this.audioTrack))}},{key:"onDisconnect",value:function(e){this.onEvent({key:Date.now(),data:{event:"play_diconnected"}}),this.opts.onDisconnect&&this.opts.onDisconnect(e)}},{key:"dispatchMessage",value:function(e){var t=this;if(!this.stopRunning){this.playerStatsObject.first_byte_at||(this.playerStatsObject.first_byte_at=Date.now(),this.addStat({first_byte_at:this.playerStatsObject.first_byte_at}));var r=e.rawData,n=e.parsedData,o=e.isDataAB;a.logDM(o,n);try{if(o){if(this.waitForInitFrame)return s.logger.log("old frames");this.sb.procArrayBuffer(r)}if(n&&n.type===c.EVENT_SEGMENT){var i=n[c.EVENT_SEGMENT];switch(s.logger.log("%c ".concat(n.type," ").concat("event"===n.type?n.event:"mse_init_segment"),"background: aquamarine;",n),i){case"resumed":this._pause&&!this.playing&&this.onStartStalling(),this.onResume&&this.onResume();break;case"paused":case"tracks_switched":break;case"seeked":case"switched_to_live":if(this.seekValue=void 0,this.opts.onSeeked)try{this.opts.onSeeked()}catch(e){s.logger.error(e)}break;case"recordings_ended":this._eos=!0,this.sb.onBufferEos();break;case"stream_unavailable":if("static"in n&&0==n.static)s.logger.info("Stream is on on demand mode, waiting for init segment"),this.onStartStalling();else{if(s.logger.warn("do playPromise reject with error"),this.ws.connectionPromise&&this.ws.connectionPromise.then((function(){return t.ws.pause()})),!this.liveError)return this.onPlayerError({error:"playPromise reject - stream unavaible"}),this.liveError=!0,this.shouldPlay=!1,void(this.resetTimer&&(clearTimeout(this.resetTimer),this.resetTimer=void 0));this.rejectThenMediaSourceOpen&&(this.rejectThenMediaSourceOpen(),this.resolveThenMediaSourceOpen=void 0,this.rejectThenMediaSourceOpen=void 0),this.mediaSource.endOfStream()}break;default:this.opts.onEvent&&this.opts.onEvent({error:"unhandled_event",event:i}),s.logger.warn("unknown type of event",i)}return}if(n&&n.type===c.MSE_INIT_SEGMENT)return this.procInitSegment(r)}catch(e){a.showDispatchError.bind(this)(e);try{if(this.media.error)this.onPlayerError({error:"Media error",mediaError:this.media.error}),this.stop();else if(this.mediaInfo&&this.mediaInfo.activeStreams){var l=this.mediaInfo.activeStreams;this.setTracks([l.video?l.video:"",l.audio?l.audio:""])}}catch(e){this.ws.pause()}}}}},{key:"procInitSegment",value:function(t){var r=this,n=JSON.parse(t);if(n.type!==c.MSE_INIT_SEGMENT)return s.logger.warn("type is not ".concat(c.MSE_INIT_SEGMENT));this.waitForInitFrame&&(this.waitForInitFrame=!1),this.resetTimer&&(clearTimeout(this.resetTimer),this.resetTimer=void 0),this.sb.isBuffered()&&(this.sb.doFlush(),this.sb.seek()),this.sb.setTracksByType(n);var o=m(m({},n.metadata),{},{tracks:n.metadata.streams?n.metadata.streams:n.metadata.tracks,streams:n.metadata.streams?n.metadata.streams:n.metadata.tracks}),i=n.metadata.streams;n.metadata.tracks&&(i=n.metadata.tracks);var a={},l=this.sb.videoTrackId&&this.sb.videoTrackId.id-1;if(i[l]&&i[l].track_id){if(i[l].bitrate&&0===i[l].bitrate||0===i[l].height||0===i[l].width)return void this.onPlayerError({error:"Video track error"});a.video=i[l].track_id}var u,p=this.sb.audioTrackId&&this.sb.audioTrackId.id-1;p&&i[p]&&i[p].track_id&&(i[p].bitrate&&0===i[p].bitrate?(this.onPlayerError({error:"Audio track error"}),n.tracks.forEach((function(e,t){e.id===r.sb.audioTrackId.id&&(u=t)})),n.tracks.splice(u,1),this.sb.sourceBuffer.audio&&(this.mediaSource.removeSourceBuffer(this.sb.sourceBuffer.audio),delete this.sb.sourceBuffer.audio)):a.audio=i[p].track_id);var f,h=m(m({},o),{},{activeStreams:a,version:e.version});this.playerStatsObject.source_id=n.session_id,this.addStat({source_id:this.playerStatsObject.source_id}),this.doMediaInfo(h),s.logger.log("%cprocInitSegment:","background: lightpink;",n),this.onEvent({key:Date.now(),data:m({event:"play_metadata"},h)}),this.mediaSource&&!this.mediaSource.sourceBuffers.length&&(this.sb.setMediaSource(this.mediaSource),this.sb.createSourceBuffers(n)),this.liveError||this.sb.createTracks(n.tracks),this.opts.videoQuality&&this.firstStart&&(this.firstStart=!1,"lowest"===this.opts.videoQuality?f=this.autoTrackSelection(!1):"highest"===this.opts.videoQuality&&(f=this.autoTrackSelection(!0)),this.ws.setTracks(f[0]||"",f[1]||"")),this.opts.preferHQ&&s.logger.info("[MSE]: preferHQ option is depricated. Use videoQuality(lowest/highest) instead"),this.ws.resume()}},{key:"doMediaInfo",value:function(e){if(s.logger.log("%cmediaInfo:","background: orange;",e),this.mediaInfo=e,this.onMediaInfo)try{this.onMediaInfo(e)}catch(e){s.logger.error(a.errorMsg(e))}}},{key:"getVideoTracks",value:function(){if(this.mediaInfo){var e=this.mediaInfo.streams?"streams":"tracks";return this.mediaInfo[e].filter((function(e){return e.content===_}))}}},{key:"getAudioTracks",value:function(){if(this.mediaInfo){var e=this.mediaInfo.streams?"streams":"tracks";return this.mediaInfo[e].filter((function(e){return e.content===k}))}}},{key:"immediateLevelSwitchEnd",value:function(){var e=this,t=this.media;t&&t.buffered.length&&(this.immediateSwitch=!1,this.previouslyPaused||(this.playPromise=t.play(),this.playPromise.then((function(){e._pause=!1,e.playing=!0}))))}},{key:"onStartStalling",value:function(){var e=this;this._pause||(this.resetTimer||(this.resetTimer=setTimeout((function(){e.restart()}),6e4)),this._stalling||(this.opts.onStartStalling&&this.opts.onStartStalling(),this._stalling=!0,s.logger.log("onStartStalling"),this.playerStatsObject.started_at&&(this.addPlayerStat("stall_count"),this.startStallingTime=Date.now()),this.onEvent({key:Date.now(),data:{event:"play_stalled"}})))}},{key:"onEndStalling",value:function(){if(this._stalling){if(this.opts.onEndStalling&&this.opts.onEndStalling(),this._stalling=!1,s.logger.log("onEndStalling"),clearTimeout(this.resetTimer),this.resetTimer=void 0,this.startStallingTime){var e=this.playerStatsObject.application;if(e){var t=e.stall_duration;t+=Date.now()-this.startStallingTime,this.startStallingTime=null,this.addPlayerStat("stall_duration",!1,t)}}this.onEvent({key:Date.now(),data:{event:"play_resumed"}})}}},{key:"startProgressTimer",value:function(){this.timer=setInterval(this.onTimer.bind(this),this.opts.progressUpdateTime)}},{key:"endProgressTimer",value:function(){clearInterval(this.timer),this.timer=void 0}},{key:"onTimer",value:function(){if(this._eos)return s.logger.log("nothing to play");if(this.immediateSwitch&&this.immediateLevelSwitchEnd(),this.sb.lastLoadedUTC!==this.utcPrev&&!this._stalling&&(this.utcPrev=this.sb.lastLoadedUTC,this.onProgress))try{this.onProgress(this.sb.lastLoadedUTC)}catch(e){s.logger.error(a.errorMsg(e))}}},{key:"onMediaSourceEnded",value:function(){s.logger.log("media source ended");try{this.opts.onEOS&&this.opts.onEOS()}catch(e){s.logger.error("error while proccessing onEOS")}}},{key:"onMediaSourceClose",value:function(){s.logger.log("media source closed")}},{key:"onConnectionRetry",value:function(){var e=this;this.retryConnectionTimer||this._stop?this.retry>=this.opts.connectionRetries&&clearInterval(this.retryConnectionTimer):this.retry<this.opts.connectionRetries&&(this.retryConnectionTimer=setInterval((function(){return e.retryConnection()}),5e3))}},{key:"loadingIndication",value:function(e){var t=e.type;"playing"===t?(this.playing=!0,this.onEndStalling(),this.playerStatsObject.started_at||(this.playerStatsObject.started_at=Date.now(),this.addStat({started_at:this.playerStatsObject.started_at}))):"waiting"===t&&(this.playing=!1,this.onStartStalling())}},{key:"onEvent",value:function(e){this.onEventCallback&&this.onEventCallback(e)}},{key:"onPlayerError",value:function(e){this.playerStatsObject&&this.addPlayerStat("error_count"),this.onError&&this.onError(e)}},{key:"addListeners",value:function(){this.media&&(this.oncvp=a.checkVideoProgress(this.media,this).bind(this),this.media.addEventListener(u.default.MEDIA_ELEMENT_PROGRESS,this.oncvp),this.media.addEventListener(u.default.MEDIA_ELEMENT_PLAYING,this.loadingIndication.bind(this)),this.media.addEventListener(u.default.MEDIA_ELEMENT_WAITING,this.loadingIndication.bind(this)))}},{key:"removeListeners",value:function(){this.media&&(this.media.removeEventListener(u.default.MEDIA_ELEMENT_PROGRESS,this.oncvp),this.media.removeEventListener(u.default.MEDIA_ELEMENT_PLAYING,this.loadingIndication),this.media.removeEventListener(u.default.MEDIA_ELEMENT_WAITING,this.loadingIndication))}},{key:"generateUUID",value:function(){var e=(new Date).getTime(),t="undefined"!=typeof performance&&performance.now&&1e3*performance.now()||0;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(r){var n=16*Math.random();return e>0?(n=(e+n)%16|0,e=Math.floor(e/16)):(n=(t+n)%16|0,t=Math.floor(t/16)),("x"===r?n:3&n|8).toString(16)}))}},{key:"addPlayerStat",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=this.playerStatsObject.application;n&&(r?n[e]=Math.round(r):t&&n[e]++,this.playerStatsObject.application=n,this.addStat({application:n}))}},{key:"addStat",value:function(e){this.statsWorker&&this.statsWorker.postMessage({command:"add",commandObj:e})}},{key:"getStats",value:function(){return m(m({},this.playerStatsObject),{},{id:this.uuid})}},{key:"onStatsWorkerMessage",value:function(){if(this.playerStatsObject.started_at&&this.opts.statsSendEnable){var e=(this.playerStatsObject&&this.playerStatsObject.source_id||{}).source_id,t=this.url.replace(/sessions/,"sessions/".concat(e?"".concat(e):""));fetch(t,{headers:{Accept:"application/json","Content-Type":"application/json"},method:"PUT",body:JSON.stringify(this.getStats())})}}}],f=[{key:"version",get:function(){return"24.6.1"}},{key:"replaceHttpByWS",value:function(e){return a.replaceHttpByWS(e)}},{key:"isSupported",value:function(){return a.isSupportedMSE()}}],l&&w(t.prototype,l),f&&w(t,f),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,l,f}(),e.exports=t.default},216:(e,t,r)=>{function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function o(){}Object.defineProperty(t,"__esModule",{value:!0}),t.logger=t.enableLogs=void 0;var i={trace:o,debug:o,log:o,warn:o,info:o,error:o},a=i;t.enableLogs=function(e){if(!0===e||"object"===n(e)){!function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];n.forEach((function(t){a[t]=e[t]?e[t].bind(e):function(e){var t=r.g.console[e];return t?function(){for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];o[0]&&(o[0]=function(e,t){return"["+e+"] > "+t}(e,o[0])),o&&t.apply(r.g.console,o)}:o}(t)}))}(e,"trace","debug","log","info","warn","error");try{a.log()}catch(e){a=i}}else a=i},t.logger=a},203:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.RawDataToUint8Array=function(e){return new Uint8Array(e)},t.base64ToArrayBuffer=function(e){return Uint8Array.from(atob(e),(function(e){return e.charCodeAt(0)}))},t.checkVideoProgress=void 0,t.debugData=c,t.doArrayBuffer=function(e){e.isInit||(this.utc=s(e.data),this.lastLoadedUTC=this.utc)},t.errorMsg=void 0,t.getMediaSource=o,t.getRealUtcFromData=s,t.getTrackId=a,t.humanTime=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!(e>0))return"";var r=e,n=new Date;n.setTime(1e3*r);var o=!(!1===t),i=o?n.getHours():n.getUTCHours(),a=o?n.getMinutes():n.getUTCMinutes(),s=o?n.getSeconds():n.getUTCSeconds();return u(i)+":"+u(a)+":"+u(s)},t.isAndroid=i,t.isSupportedMSE=function(){if(i())return!1;var e=o(),t=window.SourceBuffer||window.WebKitSourceBuffer,r=e&&"function"==typeof e.isTypeSupported&&e.isTypeSupported('video/mp4; codecs="avc1.4d401f,mp4a.40.2"'),n=!t||t.prototype&&"function"==typeof t.prototype.appendBuffer&&"function"==typeof t.prototype.remove;return!!r&&!!n},t.logDM=function(e,t){t&&n.logger.log("%c ".concat(t.type," ").concat("event"===t.type?t.event:"mse_init_segment"),"background: aquamarine;",t)},t.pad2=u,t.replaceHttpByWS=void 0,t.showDispatchError=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";"data"in e&&e.data instanceof ArrayBuffer&&n.logger.error("Data:",c(e.data)),n.logger.error(l(e),t),this.media&&"error"in this.media&&n.logger.error("MediaError:",this.media.error),++p>=this.opts.errorsBeforeStop&&(p=0,this.stopPromise=this.stop()),this.onError&&this.onError(t,e)};var n=r(216);function o(){if("undefined"!=typeof window)return window.MediaSource||window.WebKitMediaSource}function i(){return-1!==navigator.userAgent.indexOf("Android")}function a(e){return e[47]}function s(e){return(e[92]<<24|e[93]<<16|e[94]<<8|e[95])+(e[96]<<24|e[97]<<16|e[98]<<8|e[99])/1e6}function c(e){var t=new Uint8Array(e);return{trackId:a(t),utc:s(t),view:t}}t.checkVideoProgress=function(e,t){return function(){var r=e.currentTime,o=e.buffered,i=e.buffered.length,a=function(e,t,r){var n;return function(){var o=this,i=arguments,a=r&&!n;clearTimeout(n),n=setTimeout((function(){n=null,r||e.apply(o,i)}),t),a&&e.apply(o,i)}},s=function(e,t,r,o){try{for(var i=0;i<t.buffered.length;i++){var a=t.buffered.start(i),s=t.buffered.end(i),c=Math.max(a,r),l=Math.min(s,o);if(Math.min(l,s)-c>.5){if(t.updating)return;return t.remove(c,l),!0}}}catch(e){n.logger.warn("removeBufferRange failed",e)}return!1};if(t)for(var c=t.sb.sourceBuffer,l=Object.keys(c),u=r-30,p=l.length-1;p>=0;p--){var f=c[l[p]];if(f){var h=f.buffered;h.length>0&&u>h.start(0)&&a(s(0,f,0,u),100)}}if(t.media.readyState<=2&&2===t.media.networkState?t.onStartStalling():t.media.readyState>2&&t.onEndStalling(),i){var d=o.end(i-1),y=Math.abs(d-r);if(t.playerStatsObject){if(t.playerStatsObject.bytes=t.sb.totalBytesCollected,t.playerStatsObject.updated_at=Date.now(),t.playing){if(t.playbackSegmentStart){var m=t.playerStatsObject.application;if(m){var g=t.media.getVideoPlaybackQuality(),v=g.corruptedVideoFrames,b=g.droppedVideoFrames,S=g.totalVideoFrames,w=m.live_duration;w+=t.playerStatsObject.updated_at-t.playbackSegmentStart,t.addPlayerStat("live_duration",!1,w),t.addPlayerStat("total_video_frames",!1,S),t.addPlayerStat("dropped_video_frames",!1,b),t.addPlayerStat("corrupted_video_frames",!1,v)}}t.playbackSegmentStart=t.playerStatsObject.updated_at}t.addStat({updated_at:t.playerStatsObject.updated_at,bytes:t.sb.totalBytesCollected})}y<=t.opts.maxBufferDelay||(n.logger.log("nudge",r,"->",i?d:"-",r-d),e.currentTime=d-.2)}}},t.replaceHttpByWS=function(e){return e.replace(/^http/,"ws")};var l=t.errorMsg=function(e){return"Error ".concat(e.name,": ").concat(e.message,"\n").concat(e.stack)};function u(e){return e<=9?"0"+e:""+e}var p=0},75:(e,t,r)=>{var n=r(453),o=r(487),i=o(n("String.prototype.indexOf"));e.exports=function(e,t){var r=n(e,!!t);return"function"==typeof r&&i(e,".prototype.")>-1?o(r):r}},487:(e,t,r)=>{var n=r(743),o=r(453),i=r(897),a=r(675),s=o("%Function.prototype.apply%"),c=o("%Function.prototype.call%"),l=o("%Reflect.apply%",!0)||n.call(c,s),u=r(655),p=o("%Math.max%");e.exports=function(e){if("function"!=typeof e)throw new a("a function is required");var t=l(n,c,arguments);return i(t,1+p(0,e.length-(arguments.length-1)),!0)};var f=function(){return l(n,s,arguments)};u?u(e.exports,"apply",{value:f}):e.exports.apply=f},41:(e,t,r)=>{var n=r(655),o=r(68),i=r(675),a=r(795);e.exports=function(e,t,r){if(!e||"object"!=typeof e&&"function"!=typeof e)throw new i("`obj` must be an object or a function`");if("string"!=typeof t&&"symbol"!=typeof t)throw new i("`property` must be a string or a symbol`");if(arguments.length>3&&"boolean"!=typeof arguments[3]&&null!==arguments[3])throw new i("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&"boolean"!=typeof arguments[4]&&null!==arguments[4])throw new i("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&"boolean"!=typeof arguments[5]&&null!==arguments[5])throw new i("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&"boolean"!=typeof arguments[6])throw new i("`loose`, if provided, must be a boolean");var s=arguments.length>3?arguments[3]:null,c=arguments.length>4?arguments[4]:null,l=arguments.length>5?arguments[5]:null,u=arguments.length>6&&arguments[6],p=!!a&&a(e,t);if(n)n(e,t,{configurable:null===l&&p?p.configurable:!l,enumerable:null===s&&p?p.enumerable:!s,value:r,writable:null===c&&p?p.writable:!c});else{if(!u&&(s||c||l))throw new o("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.");e[t]=r}}},655:(e,t,r)=>{var n=r(453)("%Object.defineProperty%",!0)||!1;if(n)try{n({},"a",{value:1})}catch(e){n=!1}e.exports=n},237:e=>{e.exports=EvalError},383:e=>{e.exports=Error},290:e=>{e.exports=RangeError},538:e=>{e.exports=ReferenceError},68:e=>{e.exports=SyntaxError},675:e=>{e.exports=TypeError},345:e=>{e.exports=URIError},353:e=>{var t=Object.prototype.toString,r=Math.max,n=function(e,t){for(var r=[],n=0;n<e.length;n+=1)r[n]=e[n];for(var o=0;o<t.length;o+=1)r[o+e.length]=t[o];return r};e.exports=function(e){var o=this;if("function"!=typeof o||"[object Function]"!==t.apply(o))throw new TypeError("Function.prototype.bind called on incompatible "+o);for(var i,a=function(e){for(var t=[],r=1,n=0;r<e.length;r+=1,n+=1)t[n]=e[r];return t}(arguments),s=r(0,o.length-a.length),c=[],l=0;l<s;l++)c[l]="$"+l;if(i=Function("binder","return function ("+function(e){for(var t="",r=0;r<e.length;r+=1)t+=e[r],r+1<e.length&&(t+=",");return t}(c)+"){ return binder.apply(this,arguments); }")((function(){if(this instanceof i){var t=o.apply(this,n(a,arguments));return Object(t)===t?t:this}return o.apply(e,n(a,arguments))})),o.prototype){var u=function(){};u.prototype=o.prototype,i.prototype=new u,u.prototype=null}return i}},743:(e,t,r)=>{var n=r(353);e.exports=Function.prototype.bind||n},453:(e,t,r)=>{var n,o=r(383),i=r(237),a=r(290),s=r(538),c=r(68),l=r(675),u=r(345),p=Function,f=function(e){try{return p('"use strict"; return ('+e+").constructor;")()}catch(e){}},h=Object.getOwnPropertyDescriptor;if(h)try{h({},"")}catch(e){h=null}var d=function(){throw new l},y=h?function(){try{return d}catch(e){try{return h(arguments,"callee").get}catch(e){return d}}}():d,m=r(39)(),g=r(24)(),v=Object.getPrototypeOf||(g?function(e){return e.__proto__}:null),b={},S="undefined"!=typeof Uint8Array&&v?v(Uint8Array):n,w={__proto__:null,"%AggregateError%":"undefined"==typeof AggregateError?n:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"==typeof ArrayBuffer?n:ArrayBuffer,"%ArrayIteratorPrototype%":m&&v?v([][Symbol.iterator]()):n,"%AsyncFromSyncIteratorPrototype%":n,"%AsyncFunction%":b,"%AsyncGenerator%":b,"%AsyncGeneratorFunction%":b,"%AsyncIteratorPrototype%":b,"%Atomics%":"undefined"==typeof Atomics?n:Atomics,"%BigInt%":"undefined"==typeof BigInt?n:BigInt,"%BigInt64Array%":"undefined"==typeof BigInt64Array?n:BigInt64Array,"%BigUint64Array%":"undefined"==typeof BigUint64Array?n:BigUint64Array,"%Boolean%":Boolean,"%DataView%":"undefined"==typeof DataView?n:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":o,"%eval%":eval,"%EvalError%":i,"%Float32Array%":"undefined"==typeof Float32Array?n:Float32Array,"%Float64Array%":"undefined"==typeof Float64Array?n:Float64Array,"%FinalizationRegistry%":"undefined"==typeof FinalizationRegistry?n:FinalizationRegistry,"%Function%":p,"%GeneratorFunction%":b,"%Int8Array%":"undefined"==typeof Int8Array?n:Int8Array,"%Int16Array%":"undefined"==typeof Int16Array?n:Int16Array,"%Int32Array%":"undefined"==typeof Int32Array?n:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":m&&v?v(v([][Symbol.iterator]())):n,"%JSON%":"object"==typeof JSON?JSON:n,"%Map%":"undefined"==typeof Map?n:Map,"%MapIteratorPrototype%":"undefined"!=typeof Map&&m&&v?v((new Map)[Symbol.iterator]()):n,"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"==typeof Promise?n:Promise,"%Proxy%":"undefined"==typeof Proxy?n:Proxy,"%RangeError%":a,"%ReferenceError%":s,"%Reflect%":"undefined"==typeof Reflect?n:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"==typeof Set?n:Set,"%SetIteratorPrototype%":"undefined"!=typeof Set&&m&&v?v((new Set)[Symbol.iterator]()):n,"%SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?n:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":m&&v?v(""[Symbol.iterator]()):n,"%Symbol%":m?Symbol:n,"%SyntaxError%":c,"%ThrowTypeError%":y,"%TypedArray%":S,"%TypeError%":l,"%Uint8Array%":"undefined"==typeof Uint8Array?n:Uint8Array,"%Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?n:Uint8ClampedArray,"%Uint16Array%":"undefined"==typeof Uint16Array?n:Uint16Array,"%Uint32Array%":"undefined"==typeof Uint32Array?n:Uint32Array,"%URIError%":u,"%WeakMap%":"undefined"==typeof WeakMap?n:WeakMap,"%WeakRef%":"undefined"==typeof WeakRef?n:WeakRef,"%WeakSet%":"undefined"==typeof WeakSet?n:WeakSet};if(v)try{null.error}catch(e){var E=v(v(e));w["%Error.prototype%"]=E}var _=function e(t){var r;if("%AsyncFunction%"===t)r=f("async function () {}");else if("%GeneratorFunction%"===t)r=f("function* () {}");else if("%AsyncGeneratorFunction%"===t)r=f("async function* () {}");else if("%AsyncGenerator%"===t){var n=e("%AsyncGeneratorFunction%");n&&(r=n.prototype)}else if("%AsyncIteratorPrototype%"===t){var o=e("%AsyncGenerator%");o&&v&&(r=v(o.prototype))}return w[t]=r,r},k={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},O=r(743),T=r(957),j=O.call(Function.call,Array.prototype.concat),A=O.call(Function.apply,Array.prototype.splice),M=O.call(Function.call,String.prototype.replace),P=O.call(Function.call,String.prototype.slice),x=O.call(Function.call,RegExp.prototype.exec),I=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,D=/\\(\\)?/g,B=function(e,t){var r,n=e;if(T(k,n)&&(n="%"+(r=k[n])[0]+"%"),T(w,n)){var o=w[n];if(o===b&&(o=_(n)),void 0===o&&!t)throw new l("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:r,name:n,value:o}}throw new c("intrinsic "+e+" does not exist!")};e.exports=function(e,t){if("string"!=typeof e||0===e.length)throw new l("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!=typeof t)throw new l('"allowMissing" argument must be a boolean');if(null===x(/^%?[^%]*%?$/,e))throw new c("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var r=function(e){var t=P(e,0,1),r=P(e,-1);if("%"===t&&"%"!==r)throw new c("invalid intrinsic syntax, expected closing `%`");if("%"===r&&"%"!==t)throw new c("invalid intrinsic syntax, expected opening `%`");var n=[];return M(e,I,(function(e,t,r,o){n[n.length]=r?M(o,D,"$1"):t||e})),n}(e),n=r.length>0?r[0]:"",o=B("%"+n+"%",t),i=o.name,a=o.value,s=!1,u=o.alias;u&&(n=u[0],A(r,j([0,1],u)));for(var p=1,f=!0;p<r.length;p+=1){var d=r[p],y=P(d,0,1),m=P(d,-1);if(('"'===y||"'"===y||"`"===y||'"'===m||"'"===m||"`"===m)&&y!==m)throw new c("property names with quotes must have matching quotes");if("constructor"!==d&&f||(s=!0),T(w,i="%"+(n+="."+d)+"%"))a=w[i];else if(null!=a){if(!(d in a)){if(!t)throw new l("base intrinsic for "+e+" exists, but the property is not available.");return}if(h&&p+1>=r.length){var g=h(a,d);a=(f=!!g)&&"get"in g&&!("originalValue"in g.get)?g.get:a[d]}else f=T(a,d),a=a[d];f&&!s&&(w[i]=a)}}return a}},795:(e,t,r)=>{var n=r(453)("%Object.getOwnPropertyDescriptor%",!0);if(n)try{n([],"length")}catch(e){n=null}e.exports=n},592:(e,t,r)=>{var n=r(655),o=function(){return!!n};o.hasArrayLengthDefineBug=function(){if(!n)return null;try{return 1!==n([],"length",{value:1}).length}catch(e){return!0}},e.exports=o},24:e=>{var t={__proto__:null,foo:{}},r=Object;e.exports=function(){return{__proto__:t}.foo===t.foo&&!(t instanceof r)}},39:(e,t,r)=>{var n="undefined"!=typeof Symbol&&Symbol,o=r(333);e.exports=function(){return"function"==typeof n&&"function"==typeof Symbol&&"symbol"==typeof n("foo")&&"symbol"==typeof Symbol("bar")&&o()}},333:e=>{e.exports=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var e={},t=Symbol("test"),r=Object(t);if("string"==typeof t)return!1;if("[object Symbol]"!==Object.prototype.toString.call(t))return!1;if("[object Symbol]"!==Object.prototype.toString.call(r))return!1;for(t in e[t]=42,e)return!1;if("function"==typeof Object.keys&&0!==Object.keys(e).length)return!1;if("function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(e).length)return!1;var n=Object.getOwnPropertySymbols(e);if(1!==n.length||n[0]!==t)return!1;if(!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var o=Object.getOwnPropertyDescriptor(e,t);if(42!==o.value||!0!==o.enumerable)return!1}return!0}},957:(e,t,r)=>{var n=Function.prototype.call,o=Object.prototype.hasOwnProperty,i=r(743);e.exports=i.call(n,o)},859:(e,t,r)=>{var n="function"==typeof Map&&Map.prototype,o=Object.getOwnPropertyDescriptor&&n?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,i=n&&o&&"function"==typeof o.get?o.get:null,a=n&&Map.prototype.forEach,s="function"==typeof Set&&Set.prototype,c=Object.getOwnPropertyDescriptor&&s?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,l=s&&c&&"function"==typeof c.get?c.get:null,u=s&&Set.prototype.forEach,p="function"==typeof WeakMap&&WeakMap.prototype?WeakMap.prototype.has:null,f="function"==typeof WeakSet&&WeakSet.prototype?WeakSet.prototype.has:null,h="function"==typeof WeakRef&&WeakRef.prototype?WeakRef.prototype.deref:null,d=Boolean.prototype.valueOf,y=Object.prototype.toString,m=Function.prototype.toString,g=String.prototype.match,v=String.prototype.slice,b=String.prototype.replace,S=String.prototype.toUpperCase,w=String.prototype.toLowerCase,E=RegExp.prototype.test,_=Array.prototype.concat,k=Array.prototype.join,O=Array.prototype.slice,T=Math.floor,j="function"==typeof BigInt?BigInt.prototype.valueOf:null,A=Object.getOwnPropertySymbols,M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?Symbol.prototype.toString:null,P="function"==typeof Symbol&&"object"==typeof Symbol.iterator,x="function"==typeof Symbol&&Symbol.toStringTag&&(Symbol.toStringTag,1)?Symbol.toStringTag:null,I=Object.prototype.propertyIsEnumerable,D=("function"==typeof Reflect?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(e){return e.__proto__}:null);function B(e,t){if(e===1/0||e===-1/0||e!=e||e&&e>-1e3&&e<1e3||E.call(/e/,t))return t;var r=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if("number"==typeof e){var n=e<0?-T(-e):T(e);if(n!==e){var o=String(n),i=v.call(t,o.length+1);return b.call(o,r,"$&_")+"."+b.call(b.call(i,/([0-9]{3})/g,"$&_"),/_$/,"")}}return b.call(t,r,"$&_")}var R=r(634),L=R.custom,U=G(L)?L:null;function C(e,t,r){var n="double"===(r.quoteStyle||t)?'"':"'";return n+e+n}function N(e){return b.call(String(e),/"/g,"&quot;")}function F(e){return!("[object Array]"!==q(e)||x&&"object"==typeof e&&x in e)}function W(e){return!("[object RegExp]"!==q(e)||x&&"object"==typeof e&&x in e)}function G(e){if(P)return e&&"object"==typeof e&&e instanceof Symbol;if("symbol"==typeof e)return!0;if(!e||"object"!=typeof e||!M)return!1;try{return M.call(e),!0}catch(e){}return!1}e.exports=function e(t,n,o,s){var c=n||{};if(V(c,"quoteStyle")&&"single"!==c.quoteStyle&&"double"!==c.quoteStyle)throw new TypeError('option "quoteStyle" must be "single" or "double"');if(V(c,"maxStringLength")&&("number"==typeof c.maxStringLength?c.maxStringLength<0&&c.maxStringLength!==1/0:null!==c.maxStringLength))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var y=!V(c,"customInspect")||c.customInspect;if("boolean"!=typeof y&&"symbol"!==y)throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(V(c,"indent")&&null!==c.indent&&"\t"!==c.indent&&!(parseInt(c.indent,10)===c.indent&&c.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(V(c,"numericSeparator")&&"boolean"!=typeof c.numericSeparator)throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var S=c.numericSeparator;if(void 0===t)return"undefined";if(null===t)return"null";if("boolean"==typeof t)return t?"true":"false";if("string"==typeof t)return $(t,c);if("number"==typeof t){if(0===t)return 1/0/t>0?"0":"-0";var E=String(t);return S?B(t,E):E}if("bigint"==typeof t){var T=String(t)+"n";return S?B(t,T):T}var A=void 0===c.depth?5:c.depth;if(void 0===o&&(o=0),o>=A&&A>0&&"object"==typeof t)return F(t)?"[Array]":"[Object]";var L,H=function(e,t){var r;if("\t"===e.indent)r="\t";else{if(!("number"==typeof e.indent&&e.indent>0))return null;r=k.call(Array(e.indent+1)," ")}return{base:r,prev:k.call(Array(t+1),r)}}(c,o);if(void 0===s)s=[];else if(Q(s,t)>=0)return"[Circular]";function K(t,r,n){if(r&&(s=O.call(s)).push(r),n){var i={depth:c.depth};return V(c,"quoteStyle")&&(i.quoteStyle=c.quoteStyle),e(t,i,o+1,s)}return e(t,c,o+1,s)}if("function"==typeof t&&!W(t)){var ee=function(e){if(e.name)return e.name;var t=g.call(m.call(e),/^function\s*([\w$]+)/);return t?t[1]:null}(t),te=X(t,K);return"[Function"+(ee?": "+ee:" (anonymous)")+"]"+(te.length>0?" { "+k.call(te,", ")+" }":"")}if(G(t)){var re=P?b.call(String(t),/^(Symbol\(.*\))_[^)]*$/,"$1"):M.call(t);return"object"!=typeof t||P?re:z(re)}if((L=t)&&"object"==typeof L&&("undefined"!=typeof HTMLElement&&L instanceof HTMLElement||"string"==typeof L.nodeName&&"function"==typeof L.getAttribute)){for(var ne="<"+w.call(String(t.nodeName)),oe=t.attributes||[],ie=0;ie<oe.length;ie++)ne+=" "+oe[ie].name+"="+C(N(oe[ie].value),"double",c);return ne+=">",t.childNodes&&t.childNodes.length&&(ne+="..."),ne+"</"+w.call(String(t.nodeName))+">"}if(F(t)){if(0===t.length)return"[]";var ae=X(t,K);return H&&!function(e){for(var t=0;t<e.length;t++)if(Q(e[t],"\n")>=0)return!1;return!0}(ae)?"["+Z(ae,H)+"]":"[ "+k.call(ae,", ")+" ]"}if(function(e){return!("[object Error]"!==q(e)||x&&"object"==typeof e&&x in e)}(t)){var se=X(t,K);return"cause"in Error.prototype||!("cause"in t)||I.call(t,"cause")?0===se.length?"["+String(t)+"]":"{ ["+String(t)+"] "+k.call(se,", ")+" }":"{ ["+String(t)+"] "+k.call(_.call("[cause]: "+K(t.cause),se),", ")+" }"}if("object"==typeof t&&y){if(U&&"function"==typeof t[U]&&R)return R(t,{depth:A-o});if("symbol"!==y&&"function"==typeof t.inspect)return t.inspect()}if(function(e){if(!i||!e||"object"!=typeof e)return!1;try{i.call(e);try{l.call(e)}catch(e){return!0}return e instanceof Map}catch(e){}return!1}(t)){var ce=[];return a&&a.call(t,(function(e,r){ce.push(K(r,t,!0)+" => "+K(e,t))})),Y("Map",i.call(t),ce,H)}if(function(e){if(!l||!e||"object"!=typeof e)return!1;try{l.call(e);try{i.call(e)}catch(e){return!0}return e instanceof Set}catch(e){}return!1}(t)){var le=[];return u&&u.call(t,(function(e){le.push(K(e,t))})),Y("Set",l.call(t),le,H)}if(function(e){if(!p||!e||"object"!=typeof e)return!1;try{p.call(e,p);try{f.call(e,f)}catch(e){return!0}return e instanceof WeakMap}catch(e){}return!1}(t))return J("WeakMap");if(function(e){if(!f||!e||"object"!=typeof e)return!1;try{f.call(e,f);try{p.call(e,p)}catch(e){return!0}return e instanceof WeakSet}catch(e){}return!1}(t))return J("WeakSet");if(function(e){if(!h||!e||"object"!=typeof e)return!1;try{return h.call(e),!0}catch(e){}return!1}(t))return J("WeakRef");if(function(e){return!("[object Number]"!==q(e)||x&&"object"==typeof e&&x in e)}(t))return z(K(Number(t)));if(function(e){if(!e||"object"!=typeof e||!j)return!1;try{return j.call(e),!0}catch(e){}return!1}(t))return z(K(j.call(t)));if(function(e){return!("[object Boolean]"!==q(e)||x&&"object"==typeof e&&x in e)}(t))return z(d.call(t));if(function(e){return!("[object String]"!==q(e)||x&&"object"==typeof e&&x in e)}(t))return z(K(String(t)));if("undefined"!=typeof window&&t===window)return"{ [object Window] }";if("undefined"!=typeof globalThis&&t===globalThis||void 0!==r.g&&t===r.g)return"{ [object globalThis] }";if(!function(e){return!("[object Date]"!==q(e)||x&&"object"==typeof e&&x in e)}(t)&&!W(t)){var ue=X(t,K),pe=D?D(t)===Object.prototype:t instanceof Object||t.constructor===Object,fe=t instanceof Object?"":"null prototype",he=!pe&&x&&Object(t)===t&&x in t?v.call(q(t),8,-1):fe?"Object":"",de=(pe||"function"!=typeof t.constructor?"":t.constructor.name?t.constructor.name+" ":"")+(he||fe?"["+k.call(_.call([],he||[],fe||[]),": ")+"] ":"");return 0===ue.length?de+"{}":H?de+"{"+Z(ue,H)+"}":de+"{ "+k.call(ue,", ")+" }"}return String(t)};var H=Object.prototype.hasOwnProperty||function(e){return e in this};function V(e,t){return H.call(e,t)}function q(e){return y.call(e)}function Q(e,t){if(e.indexOf)return e.indexOf(t);for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1}function $(e,t){if(e.length>t.maxStringLength){var r=e.length-t.maxStringLength,n="... "+r+" more character"+(r>1?"s":"");return $(v.call(e,0,t.maxStringLength),t)+n}return C(b.call(b.call(e,/(['\\])/g,"\\$1"),/[\x00-\x1f]/g,K),"single",t)}function K(e){var t=e.charCodeAt(0),r={8:"b",9:"t",10:"n",12:"f",13:"r"}[t];return r?"\\"+r:"\\x"+(t<16?"0":"")+S.call(t.toString(16))}function z(e){return"Object("+e+")"}function J(e){return e+" { ? }"}function Y(e,t,r,n){return e+" ("+t+") {"+(n?Z(r,n):k.call(r,", "))+"}"}function Z(e,t){if(0===e.length)return"";var r="\n"+t.prev+t.base;return r+k.call(e,","+r)+"\n"+t.prev}function X(e,t){var r=F(e),n=[];if(r){n.length=e.length;for(var o=0;o<e.length;o++)n[o]=V(e,o)?t(e[o],e):""}var i,a="function"==typeof A?A(e):[];if(P){i={};for(var s=0;s<a.length;s++)i["$"+a[s]]=a[s]}for(var c in e)V(e,c)&&(r&&String(Number(c))===c&&c<e.length||P&&i["$"+c]instanceof Symbol||(E.call(/[^\w$]/,c)?n.push(t(c,e)+": "+t(e[c],e)):n.push(c+": "+t(e[c],e))));if("function"==typeof A)for(var l=0;l<a.length;l++)I.call(e,a[l])&&n.push("["+t(a[l])+"]: "+t(e[a[l]],e));return n}},189:(e,t,r)=>{var n=r(835),o=n.parse,i=n.Url;function a(e){var t=e.url;if(void 0!==t){var r=e._parsedUrl;return c(t,r)?r:((r=s(t))._raw=t,e._parsedUrl=r)}}function s(e){if("string"!=typeof e||47!==e.charCodeAt(0))return o(e);for(var t=e,r=null,n=null,a=1;a<e.length;a++)switch(e.charCodeAt(a)){case 63:null===n&&(t=e.substring(0,a),r=e.substring(a+1),n=e.substring(a));break;case 9:case 10:case 12:case 13:case 32:case 35:case 160:case 65279:return o(e)}var s=void 0!==i?new i:{};return s.path=e,s.href=e,s.pathname=t,null!==n&&(s.query=r,s.search=n),s}function c(e,t){return"object"==typeof t&&null!==t&&(void 0===i||t instanceof i)&&t._raw===e}e.exports=a,e.exports.original=function(e){var t=e.originalUrl;if("string"!=typeof t)return a(e);var r=e._parsedOriginalUrl;return c(t,r)?r:((r=s(t))._raw=t,e._parsedOriginalUrl=r)}},897:(e,t,r)=>{var n=r(453),o=r(41),i=r(592)(),a=r(795),s=r(675),c=n("%Math.floor%");e.exports=function(e,t){if("function"!=typeof e)throw new s("`fn` is not a function");if("number"!=typeof t||t<0||t>4294967295||c(t)!==t)throw new s("`length` must be a positive 32-bit integer");var r=arguments.length>2&&!!arguments[2],n=!0,l=!0;if("length"in e&&a){var u=a(e,"length");u&&!u.configurable&&(n=!1),u&&!u.writable&&(l=!1)}return(n||l||!r)&&(i?o(e,"length",t,!0,!0):o(e,"length",t)),e}},920:(e,t,r)=>{var n=r(453),o=r(75),i=r(859),a=r(675),s=n("%WeakMap%",!0),c=n("%Map%",!0),l=o("WeakMap.prototype.get",!0),u=o("WeakMap.prototype.set",!0),p=o("WeakMap.prototype.has",!0),f=o("Map.prototype.get",!0),h=o("Map.prototype.set",!0),d=o("Map.prototype.has",!0),y=function(e,t){for(var r,n=e;null!==(r=n.next);n=r)if(r.key===t)return n.next=r.next,r.next=e.next,e.next=r,r};e.exports=function(){var e,t,r,n={assert:function(e){if(!n.has(e))throw new a("Side channel does not contain "+i(e))},get:function(n){if(s&&n&&("object"==typeof n||"function"==typeof n)){if(e)return l(e,n)}else if(c){if(t)return f(t,n)}else if(r)return function(e,t){var r=y(e,t);return r&&r.value}(r,n)},has:function(n){if(s&&n&&("object"==typeof n||"function"==typeof n)){if(e)return p(e,n)}else if(c){if(t)return d(t,n)}else if(r)return function(e,t){return!!y(e,t)}(r,n);return!1},set:function(n,o){s&&n&&("object"==typeof n||"function"==typeof n)?(e||(e=new s),u(e,n,o)):c?(t||(t=new c),h(t,n,o)):(r||(r={key:{},next:null}),function(e,t,r){var n=y(e,t);n?n.value=r:e.next={key:t,next:e.next,value:r}}(r,n,o))}};return n}},270:function(e,t,r){var n;e=r.nmd(e),function(){t&&t.nodeType,e&&e.nodeType;var o="object"==typeof r.g&&r.g;o.global!==o&&o.window!==o&&o.self;var i,a=2147483647,s=36,c=/^xn--/,l=/[^\x20-\x7E]/,u=/[\x2E\u3002\uFF0E\uFF61]/g,p={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},f=Math.floor,h=String.fromCharCode;function d(e){throw new RangeError(p[e])}function y(e,t){for(var r=e.length,n=[];r--;)n[r]=t(e[r]);return n}function m(e,t){var r=e.split("@"),n="";return r.length>1&&(n=r[0]+"@",e=r[1]),n+y((e=e.replace(u,".")).split("."),t).join(".")}function g(e){for(var t,r,n=[],o=0,i=e.length;o<i;)(t=e.charCodeAt(o++))>=55296&&t<=56319&&o<i?56320==(64512&(r=e.charCodeAt(o++)))?n.push(((1023&t)<<10)+(1023&r)+65536):(n.push(t),o--):n.push(t);return n}function v(e){return y(e,(function(e){var t="";return e>65535&&(t+=h((e-=65536)>>>10&1023|55296),e=56320|1023&e),t+h(e)})).join("")}function b(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function S(e,t,r){var n=0;for(e=r?f(e/700):e>>1,e+=f(e/t);e>455;n+=s)e=f(e/35);return f(n+36*e/(e+38))}function w(e){var t,r,n,o,i,c,l,u,p,h,y,m=[],g=e.length,b=0,w=128,E=72;for((r=e.lastIndexOf("-"))<0&&(r=0),n=0;n<r;++n)e.charCodeAt(n)>=128&&d("not-basic"),m.push(e.charCodeAt(n));for(o=r>0?r+1:0;o<g;){for(i=b,c=1,l=s;o>=g&&d("invalid-input"),((u=(y=e.charCodeAt(o++))-48<10?y-22:y-65<26?y-65:y-97<26?y-97:s)>=s||u>f((a-b)/c))&&d("overflow"),b+=u*c,!(u<(p=l<=E?1:l>=E+26?26:l-E));l+=s)c>f(a/(h=s-p))&&d("overflow"),c*=h;E=S(b-i,t=m.length+1,0==i),f(b/t)>a-w&&d("overflow"),w+=f(b/t),b%=t,m.splice(b++,0,w)}return v(m)}function E(e){var t,r,n,o,i,c,l,u,p,y,m,v,w,E,_,k=[];for(v=(e=g(e)).length,t=128,r=0,i=72,c=0;c<v;++c)(m=e[c])<128&&k.push(h(m));for(n=o=k.length,o&&k.push("-");n<v;){for(l=a,c=0;c<v;++c)(m=e[c])>=t&&m<l&&(l=m);for(l-t>f((a-r)/(w=n+1))&&d("overflow"),r+=(l-t)*w,t=l,c=0;c<v;++c)if((m=e[c])<t&&++r>a&&d("overflow"),m==t){for(u=r,p=s;!(u<(y=p<=i?1:p>=i+26?26:p-i));p+=s)_=u-y,E=s-y,k.push(h(b(y+_%E,0))),u=f(_/E);k.push(h(b(u,0))),i=S(r,w,n==o),r=0,++n}++r,++t}return k.join("")}i={version:"1.4.1",ucs2:{decode:g,encode:v},decode:w,encode:E,toASCII:function(e){return m(e,(function(e){return l.test(e)?"xn--"+E(e):e}))},toUnicode:function(e){return m(e,(function(e){return c.test(e)?w(e.slice(4).toLowerCase()):e}))}},void 0===(n=function(){return i}.call(t,r,t,e))||(e.exports=n)}()},902:e=>{var t=String.prototype.replace,r=/%20/g,n="RFC3986";e.exports={default:n,formatters:{RFC1738:function(e){return t.call(e,r,"+")},RFC3986:function(e){return String(e)}},RFC1738:"RFC1738",RFC3986:n}},98:(e,t,r)=>{var n=r(207),o=r(969),i=r(902);e.exports={formats:i,parse:o,stringify:n}},969:(e,t,r)=>{var n=r(176),o=Object.prototype.hasOwnProperty,i=Array.isArray,a={allowDots:!1,allowEmptyArrays:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decodeDotInKeys:!1,decoder:n.decode,delimiter:"&",depth:5,duplicates:"combine",ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictDepth:!1,strictNullHandling:!1},s=function(e){return e.replace(/&#(\d+);/g,(function(e,t){return String.fromCharCode(parseInt(t,10))}))},c=function(e,t){return e&&"string"==typeof e&&t.comma&&e.indexOf(",")>-1?e.split(","):e},l=function(e,t,r,n){if(e){var i=r.allowDots?e.replace(/\.([^.[]+)/g,"[$1]"):e,a=/(\[[^[\]]*])/g,s=r.depth>0&&/(\[[^[\]]*])/.exec(i),l=s?i.slice(0,s.index):i,u=[];if(l){if(!r.plainObjects&&o.call(Object.prototype,l)&&!r.allowPrototypes)return;u.push(l)}for(var p=0;r.depth>0&&null!==(s=a.exec(i))&&p<r.depth;){if(p+=1,!r.plainObjects&&o.call(Object.prototype,s[1].slice(1,-1))&&!r.allowPrototypes)return;u.push(s[1])}if(s){if(!0===r.strictDepth)throw new RangeError("Input depth exceeded depth option of "+r.depth+" and strictDepth is true");u.push("["+i.slice(s.index)+"]")}return function(e,t,r,n){for(var o=n?t:c(t,r),i=e.length-1;i>=0;--i){var a,s=e[i];if("[]"===s&&r.parseArrays)a=r.allowEmptyArrays&&(""===o||r.strictNullHandling&&null===o)?[]:[].concat(o);else{a=r.plainObjects?Object.create(null):{};var l="["===s.charAt(0)&&"]"===s.charAt(s.length-1)?s.slice(1,-1):s,u=r.decodeDotInKeys?l.replace(/%2E/g,"."):l,p=parseInt(u,10);r.parseArrays||""!==u?!isNaN(p)&&s!==u&&String(p)===u&&p>=0&&r.parseArrays&&p<=r.arrayLimit?(a=[])[p]=o:"__proto__"!==u&&(a[u]=o):a={0:o}}o=a}return o}(u,t,r,n)}};e.exports=function(e,t){var r=function(e){if(!e)return a;if(void 0!==e.allowEmptyArrays&&"boolean"!=typeof e.allowEmptyArrays)throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(void 0!==e.decodeDotInKeys&&"boolean"!=typeof e.decodeDotInKeys)throw new TypeError("`decodeDotInKeys` option can only be `true` or `false`, when provided");if(null!==e.decoder&&void 0!==e.decoder&&"function"!=typeof e.decoder)throw new TypeError("Decoder has to be a function.");if(void 0!==e.charset&&"utf-8"!==e.charset&&"iso-8859-1"!==e.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var t=void 0===e.charset?a.charset:e.charset,r=void 0===e.duplicates?a.duplicates:e.duplicates;if("combine"!==r&&"first"!==r&&"last"!==r)throw new TypeError("The duplicates option must be either combine, first, or last");return{allowDots:void 0===e.allowDots?!0===e.decodeDotInKeys||a.allowDots:!!e.allowDots,allowEmptyArrays:"boolean"==typeof e.allowEmptyArrays?!!e.allowEmptyArrays:a.allowEmptyArrays,allowPrototypes:"boolean"==typeof e.allowPrototypes?e.allowPrototypes:a.allowPrototypes,allowSparse:"boolean"==typeof e.allowSparse?e.allowSparse:a.allowSparse,arrayLimit:"number"==typeof e.arrayLimit?e.arrayLimit:a.arrayLimit,charset:t,charsetSentinel:"boolean"==typeof e.charsetSentinel?e.charsetSentinel:a.charsetSentinel,comma:"boolean"==typeof e.comma?e.comma:a.comma,decodeDotInKeys:"boolean"==typeof e.decodeDotInKeys?e.decodeDotInKeys:a.decodeDotInKeys,decoder:"function"==typeof e.decoder?e.decoder:a.decoder,delimiter:"string"==typeof e.delimiter||n.isRegExp(e.delimiter)?e.delimiter:a.delimiter,depth:"number"==typeof e.depth||!1===e.depth?+e.depth:a.depth,duplicates:r,ignoreQueryPrefix:!0===e.ignoreQueryPrefix,interpretNumericEntities:"boolean"==typeof e.interpretNumericEntities?e.interpretNumericEntities:a.interpretNumericEntities,parameterLimit:"number"==typeof e.parameterLimit?e.parameterLimit:a.parameterLimit,parseArrays:!1!==e.parseArrays,plainObjects:"boolean"==typeof e.plainObjects?e.plainObjects:a.plainObjects,strictDepth:"boolean"==typeof e.strictDepth?!!e.strictDepth:a.strictDepth,strictNullHandling:"boolean"==typeof e.strictNullHandling?e.strictNullHandling:a.strictNullHandling}}(t);if(""===e||null==e)return r.plainObjects?Object.create(null):{};for(var u="string"==typeof e?function(e,t){var r={__proto__:null},l=t.ignoreQueryPrefix?e.replace(/^\?/,""):e;l=l.replace(/%5B/gi,"[").replace(/%5D/gi,"]");var u,p=t.parameterLimit===1/0?void 0:t.parameterLimit,f=l.split(t.delimiter,p),h=-1,d=t.charset;if(t.charsetSentinel)for(u=0;u<f.length;++u)0===f[u].indexOf("utf8=")&&("utf8=%E2%9C%93"===f[u]?d="utf-8":"utf8=%26%2310003%3B"===f[u]&&(d="iso-8859-1"),h=u,u=f.length);for(u=0;u<f.length;++u)if(u!==h){var y,m,g=f[u],v=g.indexOf("]="),b=-1===v?g.indexOf("="):v+1;-1===b?(y=t.decoder(g,a.decoder,d,"key"),m=t.strictNullHandling?null:""):(y=t.decoder(g.slice(0,b),a.decoder,d,"key"),m=n.maybeMap(c(g.slice(b+1),t),(function(e){return t.decoder(e,a.decoder,d,"value")}))),m&&t.interpretNumericEntities&&"iso-8859-1"===d&&(m=s(m)),g.indexOf("[]=")>-1&&(m=i(m)?[m]:m);var S=o.call(r,y);S&&"combine"===t.duplicates?r[y]=n.combine(r[y],m):S&&"last"!==t.duplicates||(r[y]=m)}return r}(e,r):e,p=r.plainObjects?Object.create(null):{},f=Object.keys(u),h=0;h<f.length;++h){var d=f[h],y=l(d,u[d],r,"string"==typeof e);p=n.merge(p,y,r)}return!0===r.allowSparse?p:n.compact(p)}},207:(e,t,r)=>{var n=r(920),o=r(176),i=r(902),a=Object.prototype.hasOwnProperty,s={brackets:function(e){return e+"[]"},comma:"comma",indices:function(e,t){return e+"["+t+"]"},repeat:function(e){return e}},c=Array.isArray,l=Array.prototype.push,u=function(e,t){l.apply(e,c(t)?t:[t])},p=Date.prototype.toISOString,f=i.default,h={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:o.encode,encodeValuesOnly:!1,format:f,formatter:i.formatters[f],indices:!1,serializeDate:function(e){return p.call(e)},skipNulls:!1,strictNullHandling:!1},d={},y=function e(t,r,i,a,s,l,p,f,y,m,g,v,b,S,w,E,_,k){for(var O,T=t,j=k,A=0,M=!1;void 0!==(j=j.get(d))&&!M;){var P=j.get(t);if(A+=1,void 0!==P){if(P===A)throw new RangeError("Cyclic object value");M=!0}void 0===j.get(d)&&(A=0)}if("function"==typeof m?T=m(r,T):T instanceof Date?T=b(T):"comma"===i&&c(T)&&(T=o.maybeMap(T,(function(e){return e instanceof Date?b(e):e}))),null===T){if(l)return y&&!E?y(r,h.encoder,_,"key",S):r;T=""}if("string"==typeof(O=T)||"number"==typeof O||"boolean"==typeof O||"symbol"==typeof O||"bigint"==typeof O||o.isBuffer(T))return y?[w(E?r:y(r,h.encoder,_,"key",S))+"="+w(y(T,h.encoder,_,"value",S))]:[w(r)+"="+w(String(T))];var x,I=[];if(void 0===T)return I;if("comma"===i&&c(T))E&&y&&(T=o.maybeMap(T,y)),x=[{value:T.length>0?T.join(",")||null:void 0}];else if(c(m))x=m;else{var D=Object.keys(T);x=g?D.sort(g):D}var B=f?r.replace(/\./g,"%2E"):r,R=a&&c(T)&&1===T.length?B+"[]":B;if(s&&c(T)&&0===T.length)return R+"[]";for(var L=0;L<x.length;++L){var U=x[L],C="object"==typeof U&&void 0!==U.value?U.value:T[U];if(!p||null!==C){var N=v&&f?U.replace(/\./g,"%2E"):U,F=c(T)?"function"==typeof i?i(R,N):R:R+(v?"."+N:"["+N+"]");k.set(t,A);var W=n();W.set(d,k),u(I,e(C,F,i,a,s,l,p,f,"comma"===i&&E&&c(T)?null:y,m,g,v,b,S,w,E,_,W))}}return I};e.exports=function(e,t){var r,o=e,l=function(e){if(!e)return h;if(void 0!==e.allowEmptyArrays&&"boolean"!=typeof e.allowEmptyArrays)throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(void 0!==e.encodeDotInKeys&&"boolean"!=typeof e.encodeDotInKeys)throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(null!==e.encoder&&void 0!==e.encoder&&"function"!=typeof e.encoder)throw new TypeError("Encoder has to be a function.");var t=e.charset||h.charset;if(void 0!==e.charset&&"utf-8"!==e.charset&&"iso-8859-1"!==e.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var r=i.default;if(void 0!==e.format){if(!a.call(i.formatters,e.format))throw new TypeError("Unknown format option provided.");r=e.format}var n,o=i.formatters[r],l=h.filter;if(("function"==typeof e.filter||c(e.filter))&&(l=e.filter),n=e.arrayFormat in s?e.arrayFormat:"indices"in e?e.indices?"indices":"repeat":h.arrayFormat,"commaRoundTrip"in e&&"boolean"!=typeof e.commaRoundTrip)throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var u=void 0===e.allowDots?!0===e.encodeDotInKeys||h.allowDots:!!e.allowDots;return{addQueryPrefix:"boolean"==typeof e.addQueryPrefix?e.addQueryPrefix:h.addQueryPrefix,allowDots:u,allowEmptyArrays:"boolean"==typeof e.allowEmptyArrays?!!e.allowEmptyArrays:h.allowEmptyArrays,arrayFormat:n,charset:t,charsetSentinel:"boolean"==typeof e.charsetSentinel?e.charsetSentinel:h.charsetSentinel,commaRoundTrip:e.commaRoundTrip,delimiter:void 0===e.delimiter?h.delimiter:e.delimiter,encode:"boolean"==typeof e.encode?e.encode:h.encode,encodeDotInKeys:"boolean"==typeof e.encodeDotInKeys?e.encodeDotInKeys:h.encodeDotInKeys,encoder:"function"==typeof e.encoder?e.encoder:h.encoder,encodeValuesOnly:"boolean"==typeof e.encodeValuesOnly?e.encodeValuesOnly:h.encodeValuesOnly,filter:l,format:r,formatter:o,serializeDate:"function"==typeof e.serializeDate?e.serializeDate:h.serializeDate,skipNulls:"boolean"==typeof e.skipNulls?e.skipNulls:h.skipNulls,sort:"function"==typeof e.sort?e.sort:null,strictNullHandling:"boolean"==typeof e.strictNullHandling?e.strictNullHandling:h.strictNullHandling}}(t);"function"==typeof l.filter?o=(0,l.filter)("",o):c(l.filter)&&(r=l.filter);var p=[];if("object"!=typeof o||null===o)return"";var f=s[l.arrayFormat],d="comma"===f&&l.commaRoundTrip;r||(r=Object.keys(o)),l.sort&&r.sort(l.sort);for(var m=n(),g=0;g<r.length;++g){var v=r[g];l.skipNulls&&null===o[v]||u(p,y(o[v],v,f,d,l.allowEmptyArrays,l.strictNullHandling,l.skipNulls,l.encodeDotInKeys,l.encode?l.encoder:null,l.filter,l.sort,l.allowDots,l.serializeDate,l.format,l.formatter,l.encodeValuesOnly,l.charset,m))}var b=p.join(l.delimiter),S=!0===l.addQueryPrefix?"?":"";return l.charsetSentinel&&("iso-8859-1"===l.charset?S+="utf8=%26%2310003%3B&":S+="utf8=%E2%9C%93&"),b.length>0?S+b:""}},176:(e,t,r)=>{var n=r(902),o=Object.prototype.hasOwnProperty,i=Array.isArray,a=function(){for(var e=[],t=0;t<256;++t)e.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return e}(),s=function(e,t){for(var r=t&&t.plainObjects?Object.create(null):{},n=0;n<e.length;++n)void 0!==e[n]&&(r[n]=e[n]);return r},c=1024;e.exports={arrayToObject:s,assign:function(e,t){return Object.keys(t).reduce((function(e,r){return e[r]=t[r],e}),e)},combine:function(e,t){return[].concat(e,t)},compact:function(e){for(var t=[{obj:{o:e},prop:"o"}],r=[],n=0;n<t.length;++n)for(var o=t[n],a=o.obj[o.prop],s=Object.keys(a),c=0;c<s.length;++c){var l=s[c],u=a[l];"object"==typeof u&&null!==u&&-1===r.indexOf(u)&&(t.push({obj:a,prop:l}),r.push(u))}return function(e){for(;e.length>1;){var t=e.pop(),r=t.obj[t.prop];if(i(r)){for(var n=[],o=0;o<r.length;++o)void 0!==r[o]&&n.push(r[o]);t.obj[t.prop]=n}}}(t),e},decode:function(e,t,r){var n=e.replace(/\+/g," ");if("iso-8859-1"===r)return n.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(n)}catch(e){return n}},encode:function(e,t,r,o,i){if(0===e.length)return e;var s=e;if("symbol"==typeof e?s=Symbol.prototype.toString.call(e):"string"!=typeof e&&(s=String(e)),"iso-8859-1"===r)return escape(s).replace(/%u[0-9a-f]{4}/gi,(function(e){return"%26%23"+parseInt(e.slice(2),16)+"%3B"}));for(var l="",u=0;u<s.length;u+=c){for(var p=s.length>=c?s.slice(u,u+c):s,f=[],h=0;h<p.length;++h){var d=p.charCodeAt(h);45===d||46===d||95===d||126===d||d>=48&&d<=57||d>=65&&d<=90||d>=97&&d<=122||i===n.RFC1738&&(40===d||41===d)?f[f.length]=p.charAt(h):d<128?f[f.length]=a[d]:d<2048?f[f.length]=a[192|d>>6]+a[128|63&d]:d<55296||d>=57344?f[f.length]=a[224|d>>12]+a[128|d>>6&63]+a[128|63&d]:(h+=1,d=65536+((1023&d)<<10|1023&p.charCodeAt(h)),f[f.length]=a[240|d>>18]+a[128|d>>12&63]+a[128|d>>6&63]+a[128|63&d])}l+=f.join("")}return l},isBuffer:function(e){return!(!e||"object"!=typeof e||!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e)))},isRegExp:function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},maybeMap:function(e,t){if(i(e)){for(var r=[],n=0;n<e.length;n+=1)r.push(t(e[n]));return r}return t(e)},merge:function e(t,r,n){if(!r)return t;if("object"!=typeof r){if(i(t))t.push(r);else{if(!t||"object"!=typeof t)return[t,r];(n&&(n.plainObjects||n.allowPrototypes)||!o.call(Object.prototype,r))&&(t[r]=!0)}return t}if(!t||"object"!=typeof t)return[t].concat(r);var a=t;return i(t)&&!i(r)&&(a=s(t,n)),i(t)&&i(r)?(r.forEach((function(r,i){if(o.call(t,i)){var a=t[i];a&&"object"==typeof a&&r&&"object"==typeof r?t[i]=e(a,r,n):t.push(r)}else t[i]=r})),t):Object.keys(r).reduce((function(t,i){var a=r[i];return o.call(t,i)?t[i]=e(t[i],a,n):t[i]=a,t}),a)}}},835:(e,t,r)=>{var n=r(270);function o(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var i=/^([a-z0-9.+-]+:)/i,a=/:[0-9]*$/,s=/^(\/\/?(?!\/)[^?\s]*)(\?[^\s]*)?$/,c=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),l=["'"].concat(c),u=["%","/","?",";","#"].concat(l),p=["/","?","#"],f=/^[+a-z0-9A-Z_-]{0,63}$/,h=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,d={javascript:!0,"javascript:":!0},y={javascript:!0,"javascript:":!0},m={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},g=r(98);function v(e,t,r){if(e&&"object"==typeof e&&e instanceof o)return e;var n=new o;return n.parse(e,t,r),n}o.prototype.parse=function(e,t,r){if("string"!=typeof e)throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var o=e.indexOf("?"),a=-1!==o&&o<e.indexOf("#")?"?":"#",c=e.split(a);c[0]=c[0].replace(/\\/g,"/");var v=e=c.join(a);if(v=v.trim(),!r&&1===e.split("#").length){var b=s.exec(v);if(b)return this.path=v,this.href=v,this.pathname=b[1],b[2]?(this.search=b[2],this.query=t?g.parse(this.search.substr(1)):this.search.substr(1)):t&&(this.search="",this.query={}),this}var S=i.exec(v);if(S){var w=(S=S[0]).toLowerCase();this.protocol=w,v=v.substr(S.length)}if(r||S||v.match(/^\/\/[^@/]+@[^@/]+/)){var E="//"===v.substr(0,2);!E||S&&y[S]||(v=v.substr(2),this.slashes=!0)}if(!y[S]&&(E||S&&!m[S])){for(var _,k,O=-1,T=0;T<p.length;T++)-1!==(j=v.indexOf(p[T]))&&(-1===O||j<O)&&(O=j);for(-1!==(k=-1===O?v.lastIndexOf("@"):v.lastIndexOf("@",O))&&(_=v.slice(0,k),v=v.slice(k+1),this.auth=decodeURIComponent(_)),O=-1,T=0;T<u.length;T++){var j;-1!==(j=v.indexOf(u[T]))&&(-1===O||j<O)&&(O=j)}-1===O&&(O=v.length),this.host=v.slice(0,O),v=v.slice(O),this.parseHost(),this.hostname=this.hostname||"";var A="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!A)for(var M=this.hostname.split(/\./),P=(T=0,M.length);T<P;T++){var x=M[T];if(x&&!x.match(f)){for(var I="",D=0,B=x.length;D<B;D++)x.charCodeAt(D)>127?I+="x":I+=x[D];if(!I.match(f)){var R=M.slice(0,T),L=M.slice(T+1),U=x.match(h);U&&(R.push(U[1]),L.unshift(U[2])),L.length&&(v="/"+L.join(".")+v),this.hostname=R.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),A||(this.hostname=n.toASCII(this.hostname));var C=this.port?":"+this.port:"",N=this.hostname||"";this.host=N+C,this.href+=this.host,A&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==v[0]&&(v="/"+v))}if(!d[w])for(T=0,P=l.length;T<P;T++){var F=l[T];if(-1!==v.indexOf(F)){var W=encodeURIComponent(F);W===F&&(W=escape(F)),v=v.split(F).join(W)}}var G=v.indexOf("#");-1!==G&&(this.hash=v.substr(G),v=v.slice(0,G));var H=v.indexOf("?");if(-1!==H?(this.search=v.substr(H),this.query=v.substr(H+1),t&&(this.query=g.parse(this.query)),v=v.slice(0,H)):t&&(this.search="",this.query={}),v&&(this.pathname=v),m[w]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){C=this.pathname||"";var V=this.search||"";this.path=C+V}return this.href=this.format(),this},o.prototype.format=function(){var e=this.auth||"";e&&(e=(e=encodeURIComponent(e)).replace(/%3A/i,":"),e+="@");var t=this.protocol||"",r=this.pathname||"",n=this.hash||"",o=!1,i="";this.host?o=e+this.host:this.hostname&&(o=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(o+=":"+this.port)),this.query&&"object"==typeof this.query&&Object.keys(this.query).length&&(i=g.stringify(this.query,{arrayFormat:"repeat",addQueryPrefix:!1}));var a=this.search||i&&"?"+i||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||m[t])&&!1!==o?(o="//"+(o||""),r&&"/"!==r.charAt(0)&&(r="/"+r)):o||(o=""),n&&"#"!==n.charAt(0)&&(n="#"+n),a&&"?"!==a.charAt(0)&&(a="?"+a),t+o+(r=r.replace(/[?#]/g,(function(e){return encodeURIComponent(e)})))+(a=a.replace("#","%23"))+n},o.prototype.resolve=function(e){return this.resolveObject(v(e,!1,!0)).format()},o.prototype.resolveObject=function(e){if("string"==typeof e){var t=new o;t.parse(e,!1,!0),e=t}for(var r=new o,n=Object.keys(this),i=0;i<n.length;i++){var a=n[i];r[a]=this[a]}if(r.hash=e.hash,""===e.href)return r.href=r.format(),r;if(e.slashes&&!e.protocol){for(var s=Object.keys(e),c=0;c<s.length;c++){var l=s[c];"protocol"!==l&&(r[l]=e[l])}return m[r.protocol]&&r.hostname&&!r.pathname&&(r.pathname="/",r.path=r.pathname),r.href=r.format(),r}if(e.protocol&&e.protocol!==r.protocol){if(!m[e.protocol]){for(var u=Object.keys(e),p=0;p<u.length;p++){var f=u[p];r[f]=e[f]}return r.href=r.format(),r}if(r.protocol=e.protocol,e.host||y[e.protocol])r.pathname=e.pathname;else{for(var h=(e.pathname||"").split("/");h.length&&!(e.host=h.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==h[0]&&h.unshift(""),h.length<2&&h.unshift(""),r.pathname=h.join("/")}if(r.search=e.search,r.query=e.query,r.host=e.host||"",r.auth=e.auth,r.hostname=e.hostname||e.host,r.port=e.port,r.pathname||r.search){var d=r.pathname||"",g=r.search||"";r.path=d+g}return r.slashes=r.slashes||e.slashes,r.href=r.format(),r}var v=r.pathname&&"/"===r.pathname.charAt(0),b=e.host||e.pathname&&"/"===e.pathname.charAt(0),S=b||v||r.host&&e.pathname,w=S,E=r.pathname&&r.pathname.split("/")||[],_=(h=e.pathname&&e.pathname.split("/")||[],r.protocol&&!m[r.protocol]);if(_&&(r.hostname="",r.port=null,r.host&&(""===E[0]?E[0]=r.host:E.unshift(r.host)),r.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===h[0]?h[0]=e.host:h.unshift(e.host)),e.host=null),S=S&&(""===h[0]||""===E[0])),b)r.host=e.host||""===e.host?e.host:r.host,r.hostname=e.hostname||""===e.hostname?e.hostname:r.hostname,r.search=e.search,r.query=e.query,E=h;else if(h.length)E||(E=[]),E.pop(),E=E.concat(h),r.search=e.search,r.query=e.query;else if(null!=e.search)return _&&(r.host=E.shift(),r.hostname=r.host,(A=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@"))&&(r.auth=A.shift(),r.hostname=A.shift(),r.host=r.hostname)),r.search=e.search,r.query=e.query,null===r.pathname&&null===r.search||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.href=r.format(),r;if(!E.length)return r.pathname=null,r.search?r.path="/"+r.search:r.path=null,r.href=r.format(),r;for(var k=E.slice(-1)[0],O=(r.host||e.host||E.length>1)&&("."===k||".."===k)||""===k,T=0,j=E.length;j>=0;j--)"."===(k=E[j])?E.splice(j,1):".."===k?(E.splice(j,1),T++):T&&(E.splice(j,1),T--);if(!S&&!w)for(;T--;T)E.unshift("..");!S||""===E[0]||E[0]&&"/"===E[0].charAt(0)||E.unshift(""),O&&"/"!==E.join("/").substr(-1)&&E.push("");var A,M=""===E[0]||E[0]&&"/"===E[0].charAt(0);return _&&(r.hostname=M?"":E.length?E.shift():"",r.host=r.hostname,(A=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@"))&&(r.auth=A.shift(),r.hostname=A.shift(),r.host=r.hostname)),(S=S||r.host&&E.length)&&!M&&E.unshift(""),E.length>0?r.pathname=E.join("/"):(r.pathname=null,r.path=null),null===r.pathname&&null===r.search||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.auth=e.auth||r.auth,r.slashes=r.slashes||e.slashes,r.href=r.format(),r},o.prototype.parseHost=function(){var e=this.host,t=a.exec(e);t&&(":"!==(t=t[0])&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)},t.parse=v,t.resolve=function(e,t){return v(e,!1,!0).resolve(t)},t.resolveObject=function(e,t){return e?v(e,!1,!0).resolveObject(t):t},t.format=function(e){return"string"==typeof e&&(e=v(e)),e instanceof o?e.format():o.prototype.format.call(e)},t.Url=o},512:e=>{e.exports=function(e,t,r,n){var o=self||window;try{try{var i;try{i=new o.Blob([e])}catch(t){(i=new(o.BlobBuilder||o.WebKitBlobBuilder||o.MozBlobBuilder||o.MSBlobBuilder)).append(e),i=i.getBlob()}var a=o.URL||o.webkitURL,s=a.createObjectURL(i),c=new o[t](s,r);return a.revokeObjectURL(s),c}catch(n){return new o[t]("data:application/javascript,".concat(encodeURIComponent(e)),r)}}catch(e){if(!n)throw Error("Inline worker is not supported");return new o[t](n,r)}}},634:()=>{}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var i=t[n]={id:n,loaded:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.loaded=!0,i.exports}return r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),r.p="",r(813)})(),e.exports=t()}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var i=t[n]={exports:{}};return e[n].call(i.exports,i,i.exports,r),i.exports}r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var n={};r.d(n,{A:()=>s});var o=r(163);window.vpMsePlayers=window.vpMsePlayers||new Map;const i=e=>{const t=window.vpMsePlayers,r=t.get(e);if(!e)return t.values().next().value;if(r)return r;{const r=new a(e);return t.set(e,r),r}};i.destroy=e=>{const t=window.vpMsePlayers;t.get(e)&&t.delete(e)};class a{constructor(e){if(!e)throw new Error("ElementId is required");this.elementId=e,this.streamUrl=null,this.options=null,this.config=null,this.player=null}setup(e,t={progressUpdateTime:750},r={}){if(!e)throw new Error("StreamUrl is required");this.streamUrl=e,this.options=t,this.config=r,this.initPlayer()}initPlayer(){this.player=null;const e=document.getElementById(this.elementId);if(!e)throw new Error(`Element with id "${this.elementId}" not found.`);this.videoContainer=e,this.setupHTMLTemplate(),this.player=new o(this.video,this.streamUrl,this.options),this.setInitialState(),this.addEventListeners()}setInitialState(){this.video.muted=!0,this.video.controls=this.config.controls||!0,this.play(),this.offlineStatus()}setupHTMLTemplate(){this.videoContainer.classList.add("vp-mse-player-container"),this.videoContainer.innerHTML='\n\t\t<div class="vp-mse-channel-status"></div>\n\t\t<video class="vp-mse-video"></video>\n\t\t',this.video=this.videoContainer.querySelector("video"),this.channelStatus=this.videoContainer.querySelector(".vp-mse-channel-status"),this.setSize(),this.setStyle()}setSize(){const{width:e="100%",height:t="100%"}=this.config.size||{};this.videoContainer.style.width="number"==typeof e?`${e}px`:e,this.videoContainer.style.height="number"==typeof t?`${t}px`:t}setStyle(){Object.assign(this.videoContainer.style,{position:"relative",overflow:"hidden",backgroundColor:"#000",width:"100%",height:"100%"}),Object.assign(this.video.style,{position:"absolute",width:"100%",height:"100%",top:"0",left:"0",border:"none"}),Object.assign(this.channelStatus.style,{position:"absolute",top:"10px",right:"10px",zIndex:"9999",padding:"3px 6px",borderRadius:"4px",backgroundColor:"#ffffff8e",fontFamily:"Arial, sans-serif",fontSize:"12px",fontWeight:"bold"})}addEventListeners(){this.player.onProgress=()=>{this.statusTimeout&&clearTimeout(this.statusTimeout),"live"!==this.status&&this.liveStatus(),this.statusTimeout=setTimeout((()=>{this.offlineStatus()}),1250)}}liveStatus(){this.status="live",this.channelStatus.innerHTML="Live",this.channelStatus.style.backgroundColor="#ffffff8e",this.channelStatus.style.color="#ff0000",this.fire("channelLive",{message:"Channel is online"})}offlineStatus(){this.status="offline",this.channelStatus.innerHTML="Offline",this.channelStatus.style.backgroundColor="#0000008e",this.channelStatus.style.color="#000",this.fire("channelOffline",{message:"Channel is offline"})}fire(e,t,r={}){const n=new CustomEvent(e,{detail:t,bubbles:r.bubbles||!0,cancelable:r.cancelable||!0});this.videoContainer.dispatchEvent(n)}on(e,t,r={}){this.videoContainer.addEventListener(e,t,r),this.eventListeners=this.eventListeners||[],this.eventListeners.push({eventName:e,callback:t,options:r})}off(e,t){this.videoContainer.removeEventListener(e,t)}removeEventListeners(){this.eventListeners&&this.eventListeners.forEach((({eventName:e,callback:t,options:r})=>{this.videoContainer.removeEventListener(e,t,r)}))}clearResiduals(){this.statusTimeout&&(this.statusTimeout=clearTimeout(this.statusTimeout))}play(){this.player&&this.player.play().catch((e=>{console.error("Error while playing:",e)}))}pause(){this.player&&this.player.pause()}stop(){this.player&&this.player.stop()}restart(){this.player&&(this.player.stop(),this.player.play())}destroy(){this.removeEventListeners(),this.clearResiduals(),this.videoContainer.classList.remove("vp-mse-player-container"),this.videoContainer.innerHTML="",this.video=null,this.channelStatus=null,this.status=null,this.player&&(this.player.stop(),this.player.ws.destroy(),this.player=null),i.destroy(this.elementId)}}window.vpMsePlayer=i;const s=i;var c=n.A;export{c as default};